const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CqQMKfWi.js","./vendor-Cwn_Sfyr.js","./framework-PNbq5Egl.js"])))=>i.map(i=>d[i]);
import{h as s,i as E,k as me,l as se,p as Rt,S as Xn,m as qn,n as P,o as k,q as Bs,R as Qn,t as ts,u as er,v as tr,w as sr,x as nr,y as rr,z as ar,A as or,B as ir,C as cr,D as Et,E as St,F as Ie,G as lr,H as jt,I as dr,J as ur,K as pr,L as hr,M as yt,N as vt,O as _t,P as wt,Q as st,T as Ps,U as gr,V as U,W as te,X as mr,Y as fr,Z as Fs,_ as xr,$ as br,a0 as Rr,a1 as Er,a2 as W,a3 as It,a4 as Sr,a5 as jr,a6 as yr,a7 as vr,a8 as _r,a9 as wr,aa as Ir,ab as Lr,ac as Dr,ad as Mr,ae as Ar,af as Cr,ag as Nr,ah as kr,ai as Or,aj as Tr,ak as Gr,al as Br,am as Pr,an as Fr,ao as Vr,ap as Hr,aq as Ur,ar as $r,as as Wr,at as Jr}from"./vendor-Cwn_Sfyr.js";import"./framework-PNbq5Egl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const zr="text-blue-700 hover:underline",le=({href:e,className:t=zr,children:n})=>{const r=e.startsWith("http");return s.jsx("a",{className:t,href:e,...r?{rel:"noopener noreferrer",target:"_blank"}:{},children:n})},Kr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M13 7v-6l11 11-11 11v-6h-13v-10z"})}),Vs=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"})}),Hs=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M0 16.67l2.829 2.83 9.175-9.339 9.167 9.339 2.829-2.83-11.996-12.17z"})}),je=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"})}),Zr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"})}),Yr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M15.602 4.075c2.201 1.174 4.904 3.254 6.398 5.252-1.286-.9-3.011-1.027-5.058-.549.222-1.469-.185-3.535-1.34-4.703zm-.825 6.925s1.522-7-3.335-7h-5.442v20h16v-10.629c0-3.42-4.214-3.116-7.223-2.371zm-.777-9l-3-2h-9v22h2v-20h10z"})}),Xr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M14 12l-14 9v-18l14 9zm-4-9v4l8.022 5-8.022 5v4l14-9-14-9z"})}),qr=e=>s.jsx("svg",{viewBox:"0 0 480 512",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"})}),Qr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M14.601 21.5c0 1.38-1.116 2.5-2.499 2.5-1.378 0-2.499-1.12-2.499-2.5s1.121-2.5 2.499-2.5c1.383 0 2.499 1.119 2.499 2.5zm-2.42-21.5c-4.029 0-7.06 2.693-7.06 8h3.955c0-2.304.906-4.189 3.024-4.189 1.247 0 2.57.828 2.684 2.411.123 1.666-.767 2.511-1.892 3.582-2.924 2.78-2.816 4.049-2.816 7.196h3.943c0-1.452-.157-2.508 1.838-4.659 1.331-1.436 2.986-3.222 3.021-5.943.047-3.963-2.751-6.398-6.697-6.398z"})}),Us=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M3 22v-20l18 10-18 10z"})}),ea=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"})}),ta=e=>s.jsxs("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:[s.jsx("path",{clipRule:"evenodd",d:"M12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",fill:"currentColor",fillRule:"evenodd",opacity:"0.2"}),s.jsx("path",{d:"M2 12C2 6.47715 6.47715 2 12 2V5C8.13401 5 5 8.13401 5 12H2Z",fill:"currentColor"})]}),sa=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M2 2h20v20h-20z"})}),na=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M17.026 22.957c10.957-11.421-2.326-20.865-10.384-13.309l2.464 2.352h-9.106v-8.947l2.232 2.229c14.794-13.203 31.51 7.051 14.794 17.675z"})}),ra=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M1.004 6.251l10.996-5.998 10.99 6.06-10.985 5.861-11.001-5.923zm11.996 7.676v9.82l10-5.362v-9.82l-10 5.362zm-2 0l-10-5.411v9.869l10 5.362v-9.82z"})}),aa=e=>s.jsx("svg",{viewBox:"0 0 512 512",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"})}),q=e=>e>=128?e-255-1:e,$s=e=>e<0?e+255+1:e,Ws=e=>e.toString(2).padStart(8,"0"),Q=e=>e.toString(16).padStart(2,"0").toUpperCase(),oa=e=>Ws(e).split("").map(Number),ia=(e,t,n)=>Math.min(Math.max(e,t),n),Js=e=>Number.parseInt(e,16),de=(e,t)=>{const n=[];t===void 0&&(t=e,e=0);for(let r=e;r<t;r++)n.push(r);return n},ca=e=>e.split(/(?=[A-Z])/).join(" "),la=/^\[(.*)\]$/,Lt=e=>e.replace(la,"$1"),da=/\\/g,ua=e=>e.replace(da,"\\\\"),pa=/'/g,ha=e=>e.replace(pa,"\\'"),ga=/'.*'/,ma=e=>{const t=ga.exec(e)?.[0];return t===void 0?e:e.replace(t,`'${ha(t.slice(1,-1))}'`)},fa=e=>zs(e.replace(/\\u/g,"u")),zs=e=>{try{return JSON.parse(e)}catch(t){if(t instanceof SyntaxError){const n=t.message.match(/at position (\d+)/),r=n&&Number(n[1]);if(r&&e[r-1]==="\\")return zs(e.slice(0,r-1)+e.slice(r))}throw t}},xa=e=>e.split("").map(t=>t.charCodeAt(0)),nt=e=>Object.prototype.toString.call(e),ba=(e,t)=>nt(e)===nt(t),Le=e=>nt(e)==="[object Object]",Dt=(e,t)=>e in t,Mt=(e,t)=>{const n=[],r=t.length;for(let a=0;a<r;a+=e)n.push(t.slice(a,a+e));return n},Ra=e=>e.map(t=>String.fromCharCode(t)),Ea=e=>typeof e=="function",At=e=>e(),Sa=(e,t)=>(...n)=>e(...n.slice(0,t)),ue=e=>t=>n=>e(n,t),ja=(...e)=>t=>e.reduce((n,r)=>r(n),t),ya=(e,t)=>{let n,r;return function a(...o){window.clearTimeout(r);const i=Date.now();n===void 0||i-n>=t?(e(...o),n=i):r=window.setTimeout(()=>{a(...o)},t-(i-n))}},Ct=e=>E.useReducer(t=>!t,e),Nt=e=>{const t=E.useRef(null);return t.current===null&&(t.current=Ea(e)?e():e),t.current},De=()=>E.useState(null),va=e=>{const t=E.useRef(null);return E.useInsertionEffect(()=>{t.current=e},[e]),E.useCallback((...n)=>{const r=t.current;return r(...n)},[])},kt=e=>{const[t,n]=De();return E.useEffect(()=>{if(t===null)return;const r=a=>{a.target instanceof Element&&a.target!==t&&!t.contains(a.target)&&e(a)};return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[t,e]),n},Ks=(e,t)=>{const[n,r]=De(),a=Nt({isHovered:!1});return E.useEffect(()=>{if(n===null)return;const o=()=>{t===void 0?(e(!0),a.isHovered=!0):a.timeoutId=window.setTimeout(()=>{e(!0),a.isHovered=!0},t)},i=()=>{window.clearTimeout(a.timeoutId)},l=()=>{i(),e(!1),a.isHovered=!1};return n.addEventListener("mouseenter",o),n.addEventListener("mouseleave",l),()=>{n.removeEventListener("mouseenter",o),n.removeEventListener("mouseleave",l),i(),a.isHovered&&(e(!1),a.isHovered=!1)}},[n,t,e,a]),r},ss={error:null,source:"",addressToStatementMap:{}},Ot=me({name:"assembler",initialState:ss,reducers:{setState:(e,t)=>{e.error=null,e.source=t.payload.source,e.addressToStatementMap=Object.freeze(t.payload.addressToStatementMap)},setError:(e,t)=>{e.error=t.payload,e.source="",e.addressToStatementMap={}},resetState:()=>ss},selectors:{selectAssembledSource:e=>e.source,selectAddressToStatementMap:e=>e.addressToStatementMap,selectAssemblerError:e=>e.error,selectAssemblerErrorRange:e=>e.error?.range}}),{setState:Zs,setError:Ys,resetState:Xs}=Ot.actions,{selectAssembledSource:_a,selectAddressToStatementMap:qs,selectAssemblerError:wa,selectAssemblerErrorRange:Ia}=Ot.selectors;var rt=(e=>(e[e["2 Hz"]=2]="2 Hz",e[e["4 Hz"]=4]="4 Hz",e[e["8 Hz"]=8]="8 Hz",e[e["16 Hz"]=16]="16 Hz",e[e["32 Hz"]=32]="32 Hz",e[e["64 Hz"]=64]="64 Hz",e))(rt||{});const La=["2 Hz","4 Hz","8 Hz","16 Hz","32 Hz","64 Hz"];var at=(e=>(e[e["1 second"]=1e3]="1 second",e[e["2 seconds"]=2e3]="2 seconds",e[e["4 seconds"]=4e3]="4 seconds",e[e["8 seconds"]=8e3]="8 seconds",e))(at||{});const Da=["1 second","2 seconds","4 seconds","8 seconds"],Ma={configuration:{autoAssemble:!0,clockSpeed:4,timerInterval:2e3,vimKeybindings:!1},isRunning:!1,isSuspended:!1},ns=se.withTypes(),pe=me({name:"controller",initialState:Ma,reducers:{setAutoAssemble:(e,t)=>{e.configuration.autoAssemble=t.payload},setClockSpeed:(e,t)=>{e.configuration.clockSpeed=t.payload},setTimerInterval:(e,t)=>{e.configuration.timerInterval=t.payload},setVimKeybindings:(e,t)=>{e.configuration.vimKeybindings=t.payload},setRunning:(e,t)=>{e.isRunning=t.payload},setSuspended:(e,t)=>{e.isSuspended=t.payload}},selectors:{selectAutoAssemble:e=>e.configuration.autoAssemble,selectClockSpeed:e=>e.configuration.clockSpeed,selectTimerInterval:e=>e.configuration.timerInterval,selectRuntimeConfiguration:ns([e=>e.configuration.clockSpeed,e=>e.configuration.timerInterval],(e,t)=>({clockSpeed:e,timerInterval:t})),selectVimKeybindings:e=>e.configuration.vimKeybindings,selectIsRunning:e=>e.isRunning,selectIsSuspended:e=>e.isSuspended,selectToPersist:ns([e=>e.configuration],e=>({configuration:e}))}}),{setAutoAssemble:Aa,setClockSpeed:Ca,setTimerInterval:Na,setVimKeybindings:ka,setRunning:rs,setSuspended:Fe}=pe.actions,{selectAutoAssemble:ot,selectClockSpeed:Oa,selectTimerInterval:Ta,selectRuntimeConfiguration:it,selectVimKeybindings:Qs,selectIsRunning:Ee,selectIsSuspended:Me}=pe.selectors,Re=" ",ct=250;var we=(e=>(e[e.BS=8]="BS",e[e.TAB=9]="TAB",e[e.CR=13]="CR",e[e.Space=32]="Space",e))(we||{}),v=(e=>(e.END="END",e.ADD="ADD",e.SUB="SUB",e.MUL="MUL",e.DIV="DIV",e.INC="INC",e.DEC="DEC",e.MOD="MOD",e.AND="AND",e.OR="OR",e.XOR="XOR",e.NOT="NOT",e.ROL="ROL",e.ROR="ROR",e.SHL="SHL",e.SHR="SHR",e.JMP="JMP",e.JZ="JZ",e.JNZ="JNZ",e.JS="JS",e.JNS="JNS",e.JO="JO",e.JNO="JNO",e.MOV="MOV",e.CMP="CMP",e.PUSH="PUSH",e.POP="POP",e.PUSHF="PUSHF",e.POPF="POPF",e.CALL="CALL",e.RET="RET",e.INT="INT",e.IRET="IRET",e.IN="IN",e.OUT="OUT",e.HALT="HALT",e.STI="STI",e.CLI="CLI",e.CLO="CLO",e.NOP="NOP",e.ORG="ORG",e.DB="DB",e))(v||{});const en={END:0,ADD:2,SUB:2,MUL:2,DIV:2,INC:1,DEC:1,MOD:2,AND:2,OR:2,XOR:2,NOT:1,ROL:1,ROR:1,SHL:1,SHR:1,JMP:1,JZ:1,JNZ:1,JS:1,JNS:1,JO:1,JNO:1,MOV:2,CMP:2,PUSH:1,POP:1,PUSHF:0,POPF:0,CALL:1,RET:0,INT:1,IRET:0,IN:1,OUT:1,HALT:0,STI:0,CLI:0,CLO:0,NOP:0,ORG:1,DB:1};var h=(e=>(e[e.END=0]="END",e[e.ADD_REG_TO_REG=160]="ADD_REG_TO_REG",e[e.SUB_REG_FROM_REG=161]="SUB_REG_FROM_REG",e[e.MUL_REG_BY_REG=162]="MUL_REG_BY_REG",e[e.DIV_REG_BY_REG=163]="DIV_REG_BY_REG",e[e.INC_REG=164]="INC_REG",e[e.DEC_REG=165]="DEC_REG",e[e.MOD_REG_BY_REG=166]="MOD_REG_BY_REG",e[e.AND_REG_WITH_REG=170]="AND_REG_WITH_REG",e[e.OR_REG_WITH_REG=171]="OR_REG_WITH_REG",e[e.XOR_REG_WITH_REG=172]="XOR_REG_WITH_REG",e[e.NOT_REG=173]="NOT_REG",e[e.ROL_REG=154]="ROL_REG",e[e.ROR_REG=155]="ROR_REG",e[e.SHL_REG=156]="SHL_REG",e[e.SHR_REG=157]="SHR_REG",e[e.ADD_IMM_TO_REG=176]="ADD_IMM_TO_REG",e[e.SUB_IMM_FROM_REG=177]="SUB_IMM_FROM_REG",e[e.MUL_REG_BY_IMM=178]="MUL_REG_BY_IMM",e[e.DIV_REG_BY_IMM=179]="DIV_REG_BY_IMM",e[e.MOD_REG_BY_IMM=182]="MOD_REG_BY_IMM",e[e.AND_REG_WITH_IMM=186]="AND_REG_WITH_IMM",e[e.OR_REG_WITH_IMM=187]="OR_REG_WITH_IMM",e[e.XOR_REG_WITH_IMM=188]="XOR_REG_WITH_IMM",e[e.JMP=192]="JMP",e[e.JZ=193]="JZ",e[e.JNZ=194]="JNZ",e[e.JS=195]="JS",e[e.JNS=196]="JNS",e[e.JO=197]="JO",e[e.JNO=198]="JNO",e[e.MOV_IMM_TO_REG=208]="MOV_IMM_TO_REG",e[e.MOV_VAL_FROM_ADDR_TO_REG=209]="MOV_VAL_FROM_ADDR_TO_REG",e[e.MOV_REG_TO_ADDR=210]="MOV_REG_TO_ADDR",e[e.MOV_VAL_FROM_REG_ADDR_TO_REG=211]="MOV_VAL_FROM_REG_ADDR_TO_REG",e[e.MOV_REG_TO_REG_ADDR=212]="MOV_REG_TO_REG_ADDR",e[e.CMP_REG_WITH_REG=218]="CMP_REG_WITH_REG",e[e.CMP_REG_WITH_IMM=219]="CMP_REG_WITH_IMM",e[e.CMP_REG_WITH_VAL_FROM_ADDR=220]="CMP_REG_WITH_VAL_FROM_ADDR",e[e.PUSH_FROM_REG=224]="PUSH_FROM_REG",e[e.POP_TO_REG=225]="POP_TO_REG",e[e.PUSHF=234]="PUSHF",e[e.POPF=235]="POPF",e[e.CALL_ADDR=202]="CALL_ADDR",e[e.RET=203]="RET",e[e.INT_ADDR=204]="INT_ADDR",e[e.IRET=205]="IRET",e[e.IN_FROM_PORT_TO_AL=240]="IN_FROM_PORT_TO_AL",e[e.OUT_FROM_AL_TO_PORT=241]="OUT_FROM_AL_TO_PORT",e[e.HALT=0]="HALT",e[e.STI=252]="STI",e[e.CLI=253]="CLI",e[e.CLO=254]="CLO",e[e.NOP=255]="NOP",e))(h||{});const T=(...e)=>{let t="";const n=e.length;for(let r=0;r<n;r++){const a=e[r];if(a)if(typeof a=="string")t&&(t+=" "),t+=a;else for(const o in a)a[o]&&(t&&(t+=" "),t+=o)}return t},Ga="Invariant failed";function F(e,t=""){if(!e)throw new Error(Ga)}const tn=(e,t)=>{const n={},r=Object.getOwnPropertyNames(t),a=Object.getOwnPropertySymbols(t),o=Le(e);if(o){const l=Object.getOwnPropertyNames(e),m=Object.getOwnPropertySymbols(e),R=d=>{const f=typeof d=="symbol";(!f&&!r.includes(d)||f&&!a.includes(d))&&Object.defineProperty(n,d,Object.getOwnPropertyDescriptor(e,d))};l.forEach(R),m.forEach(R)}const i=l=>{const m=t[l];if(o&&Le(m)){const d=e[l];Object.defineProperty(n,l,{...Object.getOwnPropertyDescriptor(t,l),value:tn(d,m)})}else Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(t,l))};return r.forEach(i),a.forEach(i),n},sn=(e,...t)=>t.reduce(tn,e),nn=(e,t)=>{if(!ba(e,t))return e;if(!Le(e)||!Le(t))return t;const n={},r=Object.getOwnPropertyNames(e),a=Object.getOwnPropertySymbols(e),o=Object.getOwnPropertyNames(t),i=Object.getOwnPropertySymbols(t),l=R=>{const d=typeof R=="symbol";(!d&&!o.includes(R)||d&&!i.includes(R))&&Object.defineProperty(n,R,Object.getOwnPropertyDescriptor(e,R))};r.forEach(l),a.forEach(l);const m=R=>{const d=typeof R=="symbol";if(!d&&r.includes(R)||d&&a.includes(R)){const f=e[R],g=t[R];Object.defineProperty(n,R,{...Object.getOwnPropertyDescriptor(e,R),value:nn(f,g)})}};return o.forEach(m),i.forEach(m),n},Ba=(e,...t)=>t.reduce(nn,e),rn=-1,Pa=15;var Tt=(e=>(e[e.SimulatedKeyboard=0]="SimulatedKeyboard",e[e.Thermostat=3]="Thermostat",e[e.Keyboard=7]="Keyboard",e[e.NumericKeypad=8]="NumericKeypad",e))(Tt||{});const Fa={data:{content:null,port:null},interrupt:!1};var lt=(e=>(e[e.TrafficLights=1]="TrafficLights",e[e.SevenSegmentDisplay=2]="SevenSegmentDisplay",e[e.Heater=3]="Heater",e[e.SnakeInMaze=4]="SnakeInMaze",e[e.StepperMotor=5]="StepperMotor",e[e.Lift=6]="Lift",e[e.Keyboard=7]="Keyboard",e[e.NumericKeypad=8]="NumericKeypad",e))(lt||{});const Gt=191;var Ne=(e=>(e.AL="AL",e.BL="BL",e.CL="CL",e.DL="DL",e))(Ne||{}),H=(e=>(e[e.AL=0]="AL",e[e.BL=1]="BL",e[e.CL=2]="CL",e[e.DL=3]="DL",e))(H||{}),Je=(e=>(e.IP="IP",e.SP="SP",e.SR="SR",e))(Je||{});const Va="__IS_ERROR_OBJECT",Ue=({name:e,message:t,stack:n})=>({name:e,message:t,stack:n,[Va]:!0});class K extends Error{name="RuntimeError";toPlainObject(){return Ue(this)}}class Ha extends K{constructor(t){super(`Invalid register '${Q(t)}'.`)}}class Ua extends K{constructor(){super("Can not execute code beyond the end of RAM.")}}class $a extends K{constructor(){super("Stack overflow.")}}class Wa extends K{constructor(){super("Stack underflow.")}}class Ja extends K{constructor(){super("Can not divide by zero.")}}class za extends K{constructor(t){super(`I/O ports between 0 and F are available, got '${Q(t)}'.`)}}class Ka extends K{constructor(t){super(`Input data '${Q(t)}' is greater than FF.`)}}class Za extends K{constructor(t){super(`Invalid opcode '${Q(t)}'.`)}}const dt=(e,t)=>t+e,be=(e,t)=>t-e,as=(e,t)=>t*e,an=e=>{if(e===0)throw new Ja;return e},os=(e,t)=>Math.floor(t/an(e)),Ya=e=>dt(1,e),Xa=e=>be(1,e),is=(e,t)=>t%an(e),cs=(e,t)=>t&e,ls=(e,t)=>t|e,ds=(e,t)=>t^e,qa=e=>~e,Qa=e=>e<<1|e>>7,eo=e=>e>>1|e<<7,to=e=>e<<1,so=e=>e>>1,no=2,on=(e,t)=>(e&t)===t,us=e=>on(e,16),ro=()=>({gpr:[0,0,0,0],ip:0,sp:Gt,sr:0}),j=e=>{if(e>H.DL)throw new Ha(e);return e},ao=e=>{if(e>255)throw new Ua;return e},ps=e=>{if(e<0)throw new $a;if(e>Gt)throw new Wa;return e},hs=e=>{if(e>Pa)throw new za(e);return e},oo=e=>{if(e>255)throw new Ka(e);return e},io=(e,t)=>{const n=()=>t.data,r=()=>t.interrupt,a={},o=()=>{a.halted=!0},i=()=>{a.closeWindows=!0},l=_=>{a.expectedInputPort=_},m=(_,A)=>{a.data={content:_,port:A}},R={input:t,output:a},d={},f=_=>{d.memoryData=_},g=(_,A)=>{d.cpuRegisters??={},d.cpuRegisters[_]=A};return{...Rt(e,_=>{const{memoryData:A,cpuRegisters:L}=_,x=c=>A[c],Y=(c,b)=>{A[c]=b,f({address:c,value:b})},S=c=>L.gpr[c],y=(c,b)=>{L.gpr[c]=b,g("gpr",{name:H[c],value:b})},V=()=>L.ip,M=(c=1)=>L.ip+c,$=c=>{L.ip=c,g("ip",{value:c})},u=(c=1)=>($(ao(L.ip+c)),L.ip),ae=c=>{Y(L.sp,c);const b=ps(L.sp-1);L.sp=b,g("sp",{value:b})},oe=()=>{const c=ps(L.sp+1);return L.sp=c,g("sp",{value:c}),x(L.sp)},Te=()=>L.sr,ve=c=>{L.sr=c,g("sr",{value:L.sr})},ie=c=>on(L.sr,c),qt=c=>{const b=L.sr;L.sr=c?b|16:b&-17,g("sr",{interrupt:!0,value:L.sr})},D=(c,...b)=>{const xe=b[b.length-1],_e=c(...b);let Ge=0;(xe<128&&_e>=128||xe>=128&&_e<128)&&(Ge|=4);const Qe=_e>255?_e%256:$s(_e);switch(!0){case Qe===0:Ge|=2;break;case Qe>=128:Ge|=8;break}const Yn=L.sr&16;return ve(Ge|Yn),Qe},Qt=r()&&ie(16),es=Qt?h.INT_ADDR:x(V());switch(es){case h.END:case h.HALT:{o();break}case h.ADD_REG_TO_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(dt,S(b),S(c))),u();break}case h.SUB_REG_FROM_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(be,S(b),S(c))),u();break}case h.MUL_REG_BY_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(as,S(b),S(c))),u();break}case h.DIV_REG_BY_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(os,S(b),S(c))),u();break}case h.INC_REG:{const c=j(x(u()));y(c,D(Ya,S(c))),u();break}case h.DEC_REG:{const c=j(x(u()));y(c,D(Xa,S(c))),u();break}case h.MOD_REG_BY_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(is,S(b),S(c))),u();break}case h.AND_REG_WITH_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(cs,S(b),S(c))),u();break}case h.OR_REG_WITH_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(ls,S(b),S(c))),u();break}case h.XOR_REG_WITH_REG:{const c=j(x(u())),b=j(x(u()));y(c,D(ds,S(b),S(c))),u();break}case h.NOT_REG:{const c=j(x(u()));y(c,D(qa,S(c))),u();break}case h.ROL_REG:{const c=j(x(u()));y(c,D(Qa,S(c))),u();break}case h.ROR_REG:{const c=j(x(u()));y(c,D(eo,S(c))),u();break}case h.SHL_REG:{const c=j(x(u()));y(c,D(to,S(c))),u();break}case h.SHR_REG:{const c=j(x(u()));y(c,D(so,S(c))),u();break}case h.ADD_IMM_TO_REG:{const c=j(x(u())),b=x(u());y(c,D(dt,b,S(c))),u();break}case h.SUB_IMM_FROM_REG:{const c=j(x(u())),b=x(u());y(c,D(be,b,S(c))),u();break}case h.MUL_REG_BY_IMM:{const c=j(x(u())),b=x(u());y(c,D(as,b,S(c))),u();break}case h.DIV_REG_BY_IMM:{const c=j(x(u())),b=x(u());y(c,D(os,b,S(c))),u();break}case h.MOD_REG_BY_IMM:{const c=j(x(u())),b=x(u());y(c,D(is,b,S(c))),u();break}case h.AND_REG_WITH_IMM:{const c=j(x(u())),b=x(u());y(c,D(cs,b,S(c))),u();break}case h.OR_REG_WITH_IMM:{const c=j(x(u())),b=x(u());y(c,D(ls,b,S(c))),u();break}case h.XOR_REG_WITH_IMM:{const c=j(x(u())),b=x(u());y(c,D(ds,b,S(c))),u();break}case h.JMP:{const c=q(x(M()));u(c);break}case h.JZ:{const c=q(x(M()));u(ie(2)?c:2);break}case h.JNZ:{const c=q(x(M()));u(ie(2)?2:c);break}case h.JS:{const c=q(x(M()));u(ie(8)?c:2);break}case h.JNS:{const c=q(x(M()));u(ie(8)?2:c);break}case h.JO:{const c=q(x(M()));u(ie(4)?c:2);break}case h.JNO:{const c=q(x(M()));u(ie(4)?2:c);break}case h.MOV_IMM_TO_REG:{const c=j(x(u())),b=x(u());y(c,b),u();break}case h.MOV_VAL_FROM_ADDR_TO_REG:{const c=j(x(u())),b=x(u());y(c,x(b)),u();break}case h.MOV_REG_TO_ADDR:{const c=x(u()),b=j(x(u()));Y(c,S(b)),u();break}case h.MOV_VAL_FROM_REG_ADDR_TO_REG:{const c=j(x(u())),b=j(x(u())),xe=S(b);y(c,x(xe)),u();break}case h.MOV_REG_TO_REG_ADDR:{const c=j(x(u())),b=S(c),xe=j(x(u()));Y(b,S(xe)),u();break}case h.CMP_REG_WITH_REG:{const c=j(x(u())),b=j(x(u()));D(be,S(b),S(c)),u();break}case h.CMP_REG_WITH_IMM:{const c=j(x(u())),b=x(u());D(be,b,S(c)),u();break}case h.CMP_REG_WITH_VAL_FROM_ADDR:{const c=j(x(u())),b=x(u());D(be,x(b),S(c)),u();break}case h.PUSH_FROM_REG:{const c=j(x(u()));ae(S(c)),u();break}case h.POP_TO_REG:{const c=j(x(u()));y(c,oe()),u();break}case h.PUSHF:{ae(Te()),u();break}case h.POPF:{ve(oe()),u();break}case h.CALL_ADDR:{const c=x(M());ae(M(2)),$(c);break}case h.RET:{$(oe());break}case h.INT_ADDR:{if(Qt){ae(V()),$(x(no));break}const c=x(M());ae(M(2)),$(x(c));break}case h.IRET:{$(oe());break}case h.IN_FROM_PORT_TO_AL:{const c=n(),b=hs(x(M()));if(c.content===null||c.port!==b){l(b);break}c.content!==rn&&y(H.AL,oo(c.content)),u(2);break}case h.OUT_FROM_AL_TO_PORT:{const c=S(H.AL),b=hs(x(u()));m(c,b),u();break}case h.STI:{qt(!0),u();break}case h.CLI:{qt(!1),u();break}case h.CLO:{i(),u();break}case h.NOP:{u();break}default:throw new Za(es)}}),signals:R,changes:d}},gs={status:{fault:null,halted:!1},registers:ro()},ms=se.withTypes(),Bt=me({name:"cpu",initialState:gs,reducers:{setFault:(e,t)=>{e.status.fault=t.payload},setHalted:e=>{e.status.halted=!0},setRegisters:(e,t)=>{e.registers=t.payload},resetState:()=>gs},selectors:{selectCpuStatus:e=>e.status,selectCpuFault:e=>e.status.fault,selectCpuRegisters:e=>e.registers,selectCpuGeneralPurposeRegister:ms([e=>e.registers.gpr,(e,t)=>t],(e,t)=>e[t]),selectCpuInstructionPointerRegister:e=>e.registers.ip,selectCpuStackPointerRegister:e=>e.registers.sp,selectCpuPointerRegisters:ms([e=>e.registers.ip,e=>e.registers.sp],(e,t)=>({ip:e,sp:t})),selectCpuStatusRegister:e=>e.registers.sr}}),{setFault:co,setHalted:ut,setRegisters:lo,resetState:cn}=Bt.actions,{selectCpuStatus:uo,selectCpuFault:po,selectCpuRegisters:ho,selectCpuGeneralPurposeRegister:ze,selectCpuInstructionPointerRegister:ln,selectCpuStackPointerRegister:go,selectCpuPointerRegisters:mo,selectCpuStatusRegister:fo}=Bt.selectors,pt=(e,t)=>{const{from:n,to:r,number:a}=e.lineAt(t);return{from:n,to:r,number:a}},dn=(e,t)=>e.from===t.from&&e.to===t.to,xo=(e,t)=>e.from<t.to&&e.to>t.from,fs=(e,t)=>t.some(n=>!n.empty&&n.from<e.to&&n.to>e.from),bo=`; --------------------------------------
;	Hardware Interrupts
; --------------------------------------
	JMP	 Start		; Jump past the table of interrupt vectors
	DB   50			; Vector at 02 pointing to address 50
Start:
	STI				; Set I flag. Enable hardware interrupts
	MOV	 AL,  30	; ASCII for '0'
Loop:
	MOV [C0], AL	; Copy the data in AL to the video RAM
	INC	 AL			; Add one to AL
	JMP	Loop
; --------------------------------------
	ORG	 50
	MOV  AL,  30	; Reset AL to ASCII for '0'
	IRET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,Ro=`; --------------------------------------
;	Keyboard Input
; --------------------------------------
	MOV  BL, C0		; Make BL point to video RAM
Loop:
	IN   00			; Wait for keyboard input
	CMP  AL, 0D		; Check if the key was Enter (Carriage Return)
	JZ  Done
	MOV [BL], AL	; Copy the data in AL to the video RAM that BL points to
	INC  BL			; Make BL point to the next video RAM location
	JNZ Loop
Done:
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,Eo=`; --------------------------------------
;	Procedures
; --------------------------------------
	MOV  AL, E0		; 1110 0000
Loop:
	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 01		; Short delay
	CALL 30			; Call procedure 30

	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 04		; Middle sized delay
	CALL 30			; Call procedure 30

	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 08		; Longer delay
	CALL 30			; Call procedure 30
	JMP  Loop
; --------------------------------------
	ORG  30
Rep:
	DEC  BL			; Subtract one from BL
	JNZ  Rep
	RET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,So=`; --------------------------------------
;	Seven-segment Display
; --------------------------------------
	JMP Start		; Jump past the data table
	DB  FA			; 0 - 1111 1010
	DB  60			; 1 - 0110 0000
	DB  B6			; 2 - 1011 0110
	DB  9E			; 3 - 1001 1110
	DB  4E			; 4 - 0100 1110
	DB  DC			; 5 - 1101 1100
	DB  FC			; 6 - 1111 1100
	DB  8A			; 7 - 1000 1010
	DB  FE			; 8 - 1111 1110
	DB  DE			; 9 - 1101 1110
	DB  00
Start:
	MOV BL,  02		; Make BL point to the first entry in the data table
	MOV AL, [BL]	; Copy data from table to AL
Loop:
	OUT 02			; Send data to seven-segment display
	INC AL			; Set the right most bit to one
	NOP NOP NOP		; Wait for three cycles
	OUT 02			; Send data to seven-segment display
	INC BL			; Make BL point to the next entry in the data table
	MOV AL, [BL]	; Copy data from table to AL
	CMP AL,  00		; Check if the next entry exists
	JNZ Loop
	JMP Start
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,jo=`; --------------------------------------
;	Software Interrupts
; --------------------------------------
	JMP Start		; Jump past the table of interrupt vectors
	DB   51			; Vector at 02 pointing to address 51
	DB   71			; Vector at 03 pointing to address 71
Start:
	INT  02			; Do interrupt 02
	INT  03			; Do interrupt 03
	JMP Start
; --------------------------------------
	ORG  50
	DB   E0
					; Interrupt code starts here
	MOV  AL, [50]	; Copy bits from RAM into AL
	NOT  AL			; Invert the bits in AL
	MOV [50], AL	; Copy inverted bits back to RAM
	OUT  01			; Send data to traffic lights
	IRET
; --------------------------------------
	ORG  70
	DB   FE
					; Interrupt code starts here
	MOV  AL, [70]	; Copy bits from RAM into AL
	NOT  AL			; Invert the bits in AL
	AND  AL,  FE	; Set the right most bit to zero
	MOV [70], AL	; Copy inverted bits back to RAM
	OUT  02			; Send data to seven-segment display
	IRET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,xs=`; --------------------------------------
;	Untitled
; --------------------------------------
	
; --------------------------------------
	END
; --------------------------------------
`,yo=`; --------------------------------------
;	Traffic Lights
; --------------------------------------
	MOV AL, 80		; 1000 0000
Loop:
	OUT 01			; Send data to traffic lights
	ROR AL			; Rotate the bits in AL to the right
	JMP Loop
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,vo=`; --------------------------------------
;	Visual Display Unit
; --------------------------------------
	JMP Start		; Jump past the data table
	DB  "Hello World!"
	DB   00
Start:
	MOV  AL,  C0	; Make AL point to video RAM
	MOV  BL,  02	; Make BL point to the first character in the string
	MOV  CL, [BL]	; Copy the data from RAM into CL
Loop:
	MOV [AL], CL	; Copy the data in CL to the video RAM that AL points to
	INC  AL			; Make AL point to the next video RAM location
	INC  BL			; Make BL point to the next character in the string
	MOV  CL, [BL]	; Copy the data from RAM into CL
	CMP  CL,  00	; Check if the next character exists
	JNZ Loop
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,_o=/;\t(.*)/,un=e=>_o.exec(e)[1],Pt={title:un(xs),content:xs},wo=e=>e===Pt.content,Io=(()=>{const{title:e,content:t}=Pt,n=t.indexOf(e);return{anchor:n,head:n+e.length}})(),pn=[Eo,jo,bo,Ro,vo,yo,So].map(e=>({title:un(e),content:e}));var ee=(e=>(e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e))(ee||{});const Lo={input:pn[4].content,breakpoints:[],message:null},Do=se.withTypes(),he=me({name:"editor",initialState:Lo,reducers:{setInput:{reducer:(e,t)=>{e.input=t.payload.value},prepare:e=>{const{value:t,isFromFile:n=!1}=e;return{payload:{value:t,isFromFile:n}}}},setBreakpoints:(e,t)=>{e.breakpoints=t.payload},addBreakpoint:(e,t)=>{const n=t.payload,r=e.breakpoints.findIndex(a=>a.from>n.from);r===-1?e.breakpoints.push(n):e.breakpoints.splice(r,0,n)},removeBreakpoint:(e,t)=>{const n=t.payload,r=e.breakpoints.findIndex(a=>dn(a,n));e.breakpoints.splice(r,1)},setMessage:(e,t)=>{e.message=t.payload},clearMessage:e=>{e.message=null}},selectors:{selectEditorInput:e=>e.input,selectEditorBreakpoints:e=>e.breakpoints,selectEditorMessage:e=>e.message,selectToPersist:Do([e=>e.input,e=>e.breakpoints],(e,t)=>({input:e,breakpoints:t}))}}),{setInput:fe,setBreakpoints:hn,addBreakpoint:Mo,removeBreakpoint:Ao,setMessage:ht,clearMessage:gt}=he.actions,{selectEditorInput:$e,selectEditorBreakpoints:gn,selectEditorMessage:mt}=he.selectors,Co=null,Ft=me({name:"exception",initialState:Co,reducers:{set:{reducer:(e,t)=>t.payload,prepare:e=>{if(e instanceof Error)return{payload:Ue(e)};{const t=new Error(`Uncaught ${JSON.stringify(e)}`);return{payload:Ue(t)}}}},clear:()=>null},selectors:{selectException:e=>e}}),{set:Se,clear:No}=Ft.actions,{selectException:ko}=Ft.selectors,mn=256,ke=192,fn=()=>new Array(mn-ke).fill(we.Space),xn=()=>new Array(ke).fill(0).concat(fn()),Oo=e=>{const t=xn();for(const n in e)t[n]=e[n];return t},To=e=>e.slice(ke),Go=e=>{const t=[];for(let n=0;n<mn;n++)t.push(n<ke?v.END:"");for(const n in e){const r=e[n];if(r===void 0)continue;const{instruction:a,operands:o}=r;if(a.mnemonic===v.DB){const i=o[0];typeof i.code=="number"?t[n]=i.value:i.value.split("").forEach((l,m)=>{t[Number(n)+m]=l})}else{t[n]=a.mnemonic;const i=Number(n)+1;o.forEach((l,m)=>{const{value:R}=l,d=l.type.endsWith("Address");t[i+m]=d?`[${R}]`:R})}}return t};var ge=(e=>(e.VisualDisplayUnit="VisualDisplayUnit",e.TrafficLights="TrafficLights",e.SevenSegmentDisplay="Seven-segmentDisplay",e))(ge||{});const bn=Object.values(ge),Bo=fn(),bs=new Array(8).fill(0),Rs={inputSignals:Fa,isWaitingForInput:!1,isWaitingForKeyboardInput:!1,devices:{VisualDisplayUnit:{data:Bo,isVisible:!0},TrafficLights:{data:bs,isVisible:!1},"Seven-segmentDisplay":{data:bs,isVisible:!1}}},Vt=me({name:"io",initialState:Rs,reducers:{setInputData:(e,t)=>{const{content:n,port:r}=t.payload;e.inputSignals.data.content=n,e.inputSignals.data.port=r},clearInputData:e=>{e.inputSignals.data.content=null,e.inputSignals.data.port=null},setInterrupt:(e,t)=>{e.inputSignals.interrupt=t.payload},setWaitingForInput:(e,t)=>{e.isWaitingForInput=t.payload},setWaitingForKeyboardInput:(e,t)=>{e.isWaitingForKeyboardInput=t.payload},setVduDataFrom:(e,t)=>{const n=t.payload;e.devices.VisualDisplayUnit.data=To(n)},setDeviceData:(e,t)=>{const{name:n,data:r}=t.payload;e.devices[n].data=oa(r)},toggleDeviceVisible:(e,t)=>{const n=t.payload;e.devices[n].isVisible=!e.devices[n].isVisible},setDevicesInvisible:e=>{bn.forEach(t=>{e.devices[t].isVisible=!1})},resetState:e=>sn(Rs,{devices:Object.entries(e.devices).reduce((t,[n,{isVisible:r}])=>Object.assign(t,{[n]:{isVisible:r}}),{})})},selectors:{selectInputSignals:e=>e.inputSignals,selectIsWaitingForInput:e=>e.isWaitingForInput,selectIsWaitingForKeyboardInput:e=>e.isWaitingForKeyboardInput,selectIoDeviceStates:e=>e.devices,selectIoDeviceData:(e,t)=>e.devices[t].data,selectIoDeviceVisibility:(e,t)=>e.devices[t].isVisible}}),{setInputData:Po,clearInputData:Es,setInterrupt:et,setWaitingForInput:Ss,setWaitingForKeyboardInput:Rn,setVduDataFrom:En,setDeviceData:Sn,toggleDeviceVisible:jn,setDevicesInvisible:Fo,resetState:yn}=Vt.actions,{selectInputSignals:Vo,selectIsWaitingForInput:Ho,selectIsWaitingForKeyboardInput:Uo,selectIoDeviceStates:$o,selectIoDeviceData:Wo,selectIoDeviceVisibility:Jo}=Vt.selectors;var We=(e=>(e.Hexadecimal="Hexadecimal",e.Decimal="Decimal",e.Source="Source",e))(We||{});const zo=Object.values(We),vn=xn(),Ko={data:vn,view:"Hexadecimal"},Zo=se.withTypes(),Ht=me({name:"memory",initialState:Ko,reducers:{initDataFrom:(e,t)=>{e.data=Oo(t.payload)},setData:(e,t)=>{e.data=t.payload},resetData:e=>{e.data=vn},setView:(e,t)=>{e.view=t.payload}},selectors:{selectMemoryData:e=>e.data,selectMemoryDataRows:Zo([e=>e.data],e=>()=>Mt(16,e)),selectMemoryView:e=>e.view}}),{initDataFrom:_n,setData:Yo,resetData:wn,setView:Xo}=Ht.actions,{selectMemoryData:Ut,selectMemoryDataRows:qo,selectMemoryView:In}=Ht.selectors,Ke=e=>t=>(...n)=>{const r=t(...n);return{...r,...e(r)}},Qo=Ke(e=>({getState:function(n){const r=e.getState();return n?n(r):r}})),ei=Ke(e=>{const t=Symbol("NIL");let n=t;return{dispatch:o=>{F(n===t),n=e.getState();try{return e.dispatch(o)}finally{n=t}},subscribeChange:o=>e.subscribe(()=>{F(n!==t),n!==e.getState()&&o()})}}),Ln=e=>{const t=new WeakMap;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))},ti=e=>t=>t.type===e.type,si=e=>e.payload,ni=()=>{const e=new Xn,t=()=>a=>o=>{const i=a(o);return qn(o)&&e.next(o),i},n=Ln(a=>e.pipe(P(ti(a)),k(si),Bs())),r=Ke(()=>({onAction:n}));return{middleware:t,enhancer:r}},js=1,ri=()=>{const e=new Qn(js),t=e.pipe(ts(),er(js)),n=o=>{const i=o.getState();return e.next(i),l=>m=>{const R=l(m);return e.next(o.getState()),R}},r=Ln(o=>t.pipe(k(o),ts(),Bs())),a=Ke(()=>({onState:r}));return{middleware:n,enhancer:a}},ai="assembler-simulator",ys=`persist:${ai}`,oi=(e,t)=>({read:()=>{try{const n=localStorage.getItem(ys);if(n!==null){const r=JSON.parse(n);if(e(r))return r}}catch{}return t},write:n=>{try{const r=JSON.stringify(n);localStorage.setItem(ys,r)}catch{}}}),Dn="shareable",ii=e=>{const t=new URL(window.location.href),n=nr(JSON.stringify(e)),r=rr(n,!0);return t.searchParams.set(Dn,r),t},ci=(e,t)=>({read:()=>{const r=new URL(window.location.href).searchParams.get(Dn);if(r!==null)try{const a=tr(r),o=sr(a,{to:"string"}),i=JSON.parse(o);if(e(i))return i}catch{}return t},write:n=>{const r=ii(n);window.history.replaceState({},"",r)}}),li=[oi,ci],di=(e,t=li)=>(n,r)=>{const a=t.map(o=>o(n,r));return{read:()=>a.map(o=>o.read()).reduce(e),write:o=>a.forEach(i=>i.write(o))}},Mn=di(Sa(sn,2))(Le,{}),ui=()=>{const e=Mn.read();return Ba({[he.reducerPath]:he.getInitialState(),[pe.reducerPath]:pe.getInitialState()},e)},pi=se(he.selectors.selectToPersist,pe.selectors.selectToPersist,(e,t)=>({[he.reducerPath]:e,[pe.reducerPath]:t})),hi=e=>Mn.write(e),I=(e,t)=>{const n=ar(mi,e,t);return E.useDebugValue(n),n},gi=or(he,Ot,pe,Ht,Bt,Vt,Ft),vs=ri(),_s=ni(),p=ir({reducer:gi,middleware:e=>e().concat(_s.middleware,vs.middleware),devTools:!1,preloadedState:ui(),enhancers:e=>e({autoBatch:!1}).concat(_s.enhancer,vs.enhancer).concat(Qo).concat(ei)});p.onState(pi).subscribe(hi);const mi=cr({getState:p.getState,subscribe:p.subscribeChange}),An=E.createContext({currentOpen:null,setCurrentOpen:()=>{throw new Error("MenuContext not initialized")}}),Ze=({children:e})=>{const[t,n]=De(),r=t!==null,{currentOpen:a,setCurrentOpen:o}=E.useContext(An),i=a!==null&&a===t,l=()=>{o(i?null:t)},m=E.useCallback(d=>{a!==null&&a!==t&&d&&o(t)},[a,t,o]),R=Ks(m);return s.jsx("div",{ref:n,className:T("flex items-center hover:bg-gray-200",{"bg-gray-200":i}),onClick:l,children:r&&e(i,R,t)})},Cn="flex h-full space-x-2 items-center",fi=({children:e})=>s.jsx("div",{className:Cn,children:e}),xi=({ref:e,children:t})=>s.jsx("div",{ref:e,className:T(Cn,"py-1 px-2 hover:active:bg-gray-300"),children:t}),C=Object.assign(fi,{Main:xi}),$t="flex space-x-4 py-1 px-2 items-center justify-between hover:bg-gray-200",bi=({onClick:e,children:t})=>s.jsxs("div",{className:$t,onClick:e,children:[t,s.jsx("span",{className:"w-4"})]}),Ri=({href:e,children:t})=>s.jsxs(le,{className:$t,href:e,children:[t,s.jsx("div",{className:"w-4",children:s.jsx(ea,{className:"mx-auto fill-gray-400",width:"0.875rem"})})]}),Ei=({children:e})=>{const[t,n]=De(),r=t!==null,[a,o]=E.useState(!1),i=Ks(o,100),l=f=>{n(f),i(f)},[m,R]=De(),d=f=>{F(f.target instanceof Node),(m===null||!m.contains(f.target))&&f.stopPropagation()};return s.jsx("div",{ref:l,className:$t,onClick:d,children:r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{children:e(a,R,t)}),s.jsx("div",{className:"w-4",children:s.jsx(Us,{className:"mx-auto",width:"0.625rem"})})]})})},O=Object.assign(bi,{ExternalLink:Ri,Expandable:Ei}),Nn=1,kn="divide-y border bg-gray-50 shadow fixed",Si=({menuElement:e,children:t})=>{const n=r=>{if(r===null)return;const{bottom:a,left:o}=e.getBoundingClientRect();r.style.top=`${a-Nn}px`,r.style.left=`${o}px`};return s.jsx("div",{ref:n,className:kn,children:t})},ji=({innerRef:e,menuItemElement:t,children:n})=>{const r=a=>{if(e(a),a===null)return;const{top:o,right:i}=t.getBoundingClientRect(),l=t.offsetTop===0;a.style.top=`${o-(l?Nn:0)}px`,a.style.left=`${i}px`};return s.jsx("div",{ref:r,className:kn,children:n})},Z=Object.assign(Si,{Expanded:ji}),yi=()=>{const e=I(ot),t=()=>{p.dispatch(Aa(!e))};return s.jsx(O,{onClick:t,children:s.jsxs(C,{children:[e?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Auto Assemble"})]})})},vi=()=>{const e=I(Oa);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Clock Speed"})]}),t&&s.jsx(Z.Expanded,{innerRef:n,menuItemElement:r,children:La.map((a,o)=>s.jsx(O,{onClick:()=>{p.dispatch(Ca(rt[a]))},children:s.jsxs(C,{children:[e===rt[a]?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},_i=()=>{const e=I(Ta);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Timer Interval"})]}),t&&s.jsx(Z.Expanded,{innerRef:n,menuItemElement:r,children:Da.map((a,o)=>s.jsx(O,{onClick:()=>{p.dispatch(Na(at[a]))},children:s.jsxs(C,{children:[e===at[a]?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},wi=()=>{const e=I(Qs),t=()=>{p.dispatch(ka(!e))};return s.jsx(O,{onClick:t,children:s.jsxs(C,{children:[e?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Vim Keybindings"})]})})},Ii=()=>s.jsx(Ze,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(C.Main,{ref:t,children:[s.jsx(aa,{}),s.jsx("span",{children:"Configuration"})]}),e&&s.jsxs(Z,{menuElement:n,children:[s.jsx(yi,{}),s.jsx(vi,{}),s.jsx(_i,{}),s.jsx(wi,{})]})]})}),N=(e,t)=>{const n=e.subscribe(t);return()=>n.unsubscribe()};class ye extends Error{range;static escape=ja(ua,ma);constructor(t,n){super(ye.escape(t)),this.range=n}toPlainObject(){return{...Ue(this),range:this.range}}}class Oe extends ye{name="TokenizeError"}class Li extends Oe{constructor(t,n){super(`Unterminated address '${t}'.`,n)}}class Di extends Oe{constructor(t,n){super(`Unterminated string '${t}'.`,n)}}class Mi extends Oe{constructor(t){super("Single quote is not allowed.",t)}}class Ai extends Oe{constructor(t,n){super(`Unexpected character '${t}'.`,n)}}class On extends Oe{constructor(){super("Unexpected end of token stream.")}}class ne extends ye{name="ParseError"}class Ci extends ne{constructor({source:t,range:n},r){super(`Expected ${r?"":"label or "}instruction, got '${t}'.`,n)}}class Ni extends ne{constructor({source:t,range:n}){const r=t.replace(/:$/,"");super(`Label should contain only letter or underscore, got '${r}'.`,n)}}class ws extends ne{constructor(){super("Expected END at the end of the source code.")}}class ki extends ne{constructor({source:t,range:n}){const r=Lt(t).trim();super(`Number '${r}' is greater than FF.`,n)}}class Oi extends ne{constructor({value:t,range:n},r){super(`UTF-16 code of character '${t[r]}' is greater than FF.`,n)}}class Ti extends ne{constructor({source:t,range:{from:n,to:r}}){const a=Lt(t).trim(),o={from:n+1,to:r-Math.min(1,a.length)};super(`Expected number or register, got '${a||"]"}'.`,o)}}class Gi extends ne{constructor({source:t,range:n},r){const a=r.map(o=>o.replace(/[A-Z]/g,i=>` ${i.toLowerCase()}`).trimStart()).reduce((o,i,l)=>{switch(l){case 0:return i;case r.length-1:return`${o} or ${i}`;default:return`${o}, ${i}`}},"");super(`Expected ${a}, got '${t}'.`,n)}}class Bi extends ne{constructor({source:t,range:n}){super(`Expected comma, got '${t}'.`,n)}}class Ye extends ye{name="AssembleError"}class Pi extends Ye{constructor({identifier:t,range:n}){super(`Duplicate label '${t}'.`,n)}}class Fi extends Ye{constructor({range:t}){super("Can not generate code beyond the end of RAM.",t)}}class Vi extends Ye{constructor({source:t,range:n}){super(`Label '${t}' does not exist.`,n)}}class Hi extends Ye{constructor({range:t}){super("Jump distance should be between -128 and 127.",t)}}var J=(e=>(e.Whitespace="Whitespace",e.Comment="Comment",e.Colon="Colon",e.Comma="Comma",e.Digits="Digits",e.Register="Register",e.Address="Address",e.String="String",e.Unknown="Unknown",e))(J||{});const Tn=[{type:"Whitespace",pattern:/\s+/},{type:"Comment",pattern:/;.*/},{type:"Colon",pattern:/:/},{type:"Comma",pattern:/,/},{type:"Digits",pattern:/\d+\b/},{type:"Register",pattern:/[a-dA-D][lL]\b/},{type:"Address",pattern:/\[.*?\]/},{type:"String",pattern:/"(?:[^\\\r\n]|\\.)*?"/},{type:"Unknown",pattern:/\w+/}],Ui=Tn.map(({pattern:e})=>`(${e.source})`).join("|"),$i=()=>new RegExp(Ui,"y"),Wi=(e,t,n)=>{const r=At(()=>{switch(e){case"Register":case"Unknown":return t.toUpperCase();case"Address":return Lt(t).trim().toUpperCase();case"String":return fa(t);default:return t}}),a=n,o=a+t.length;return{type:e,value:r,source:t,range:{from:a,to:o}}},Ji=e=>e.type==="Whitespace"||e.type==="Comment",zi=e=>{const t=$i();return{next:()=>{const n=t.lastIndex,r=t.exec(e);if(r)for(let i=0;;i++){const l=r[i+1];if(l){const{type:m}=Tn[i];return Wi(m,l,n)}}if(t.lastIndex=n,n===e.length)return null;const a={from:n,to:n+1},o=e[n];switch(o){case"[":{const[i]=e.slice(n).match(/^\[\s*\w*/);throw a.to+=i.length-1,new Li(i,a)}case'"':{const[i]=e.slice(n).match(/^".*/);throw a.to+=i.length-1,new Di(i,a)}case"'":throw new Mi(a)}throw new Ai(o,a)}}},Ki=e=>{const t=zi(e),n=()=>{let l=null;do l=t.next();while(l&&Ji(l));return l};let r=n(),a=n();const o=()=>{if(!r)throw new On;return r},i={hasMore:()=>!!r,peek:()=>r,peekNext:()=>a,advance:()=>{r=a,a=n()},consume:()=>{const l=o();return i.advance(),l},match:l=>o().type!==l?!1:(i.advance(),!0)};return i},Zi=({value:e,range:t})=>({identifier:e,range:t}),Yi=({value:e,range:t})=>({mnemonic:e,opcode:void 0,range:t});var Wt=(e=>(e.Number="Number",e.Register="Register",e.Address="Address",e.RegisterAddress="RegisterAddress",e.String="String",e.Label="Label",e))(Wt||{});const ce=(e,t)=>{const n=At(()=>{switch(e){case"Number":case"Address":return Js(t.value);case"Register":case"RegisterAddress":return F(Dt(t.value,H)),H[t.value];case"String":return xa(t.value);case"Label":return}});return{...t,type:e,code:n}},Xi=(e,t,n)=>{F(t.opcode!==void 0);const r=[];t.opcode!==null&&r.push(t.opcode),n.forEach(l=>{l.code!==void 0&&(typeof l.code=="number"?r.push(l.code):r.push(...l.code))});const a=t.range.from,i=(n.length>0?n[n.length-1]:t).range.to;return{label:e,instruction:t,operands:n,codes:r,range:{from:a,to:i}}},qi=/^[A-Z_]+$/,Gn=e=>{if(!qi.test(e.value))throw new Ni(e);return e},Qi=e=>{const t=e.peekNext();if(t?.type!==J.Colon||t.range.from!==e.peek().range.to)return null;const n=e.consume(),r=Zi(Gn(n));return e.advance(),r},tt=e=>{if(Js(e.value)>255)throw new ki(e);return e},ec=e=>{const t=e.value.length;for(let n=0;n<t;n++)if(e.value.charCodeAt(n)>255)throw new Oi(e,n);return e},Is=/^[\dA-F]+$/,tc=/^[A-D]L$/,ft=e=>(...t)=>{const n=e.consume();let r;const a=o=>t.includes(o);switch(n.type){case J.Digits:if(a(r="Number"))return ce(r,tt(n));break;case J.Register:if(a(r="Register"))return ce(r,n);break;case J.Address:if(a("Address")||a("RegisterAddress")){if(a(r="Address")&&Is.test(n.value))return ce(r,tt(n));if(a(r="RegisterAddress")&&tc.test(n.value))return ce(r,n);throw new Ti(n)}break;case J.String:if(a(r="String"))return ce(r,ec(n));break;case J.Unknown:switch(!0){case a(r="Number"):if(Is.test(n.value))return ce(r,tt(n));break;case a(r="Label"):return ce(r,Gn(n))}break}throw new Gi(n,t)},sc=e=>t=>{const n=[];t.forEach(([i])=>{n.includes(i)||n.push(i)});const r=ft(e)(...n);if(!e.match(J.Comma))throw new Bi(e.peek());const a=[];t.forEach(([i,l])=>{i===r.type&&a.push(l)});const o=ft(e)(...a);return[r,o]},nc=e=>{const t=Qi(e),n=t!==null,r=e.consume();if(r.type!==J.Unknown||!Dt(r.value,v))throw new Ci(r,n);const a=Yi(r),o=d=>{a.opcode=d},i=[],l=(...d)=>{i.push(...d)},m=r.value;switch(en[m]){case 0:{o(h[m]);break}case 1:{let d,f;const g=ft(e);switch(m){case v.INC:f=g("Register"),d=h.INC_REG;break;case v.DEC:f=g("Register"),d=h.DEC_REG;break;case v.NOT:f=g("Register"),d=h.NOT_REG;break;case v.ROL:f=g("Register"),d=h.ROL_REG;break;case v.ROR:f=g("Register"),d=h.ROR_REG;break;case v.SHL:f=g("Register"),d=h.SHL_REG;break;case v.SHR:f=g("Register"),d=h.SHR_REG;break;case v.JMP:f=g("Label"),d=h.JMP;break;case v.JZ:f=g("Label"),d=h.JZ;break;case v.JNZ:f=g("Label"),d=h.JNZ;break;case v.JS:f=g("Label"),d=h.JS;break;case v.JNS:f=g("Label"),d=h.JNS;break;case v.JO:f=g("Label"),d=h.JO;break;case v.JNO:f=g("Label"),d=h.JNO;break;case v.PUSH:f=g("Register"),d=h.PUSH_FROM_REG;break;case v.POP:f=g("Register"),d=h.POP_TO_REG;break;case v.CALL:f=g("Number"),d=h.CALL_ADDR;break;case v.INT:f=g("Number"),d=h.INT_ADDR;break;case v.IN:f=g("Number"),d=h.IN_FROM_PORT_TO_AL;break;case v.OUT:f=g("Number"),d=h.OUT_FROM_AL_TO_PORT;break;case v.ORG:f=g("Number"),d=null;break;case v.DB:f=g("Number","String"),d=null;break}o(d),l(f);break}case 2:{let d,f,g;const w=sc(e);switch(m){case v.ADD:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.ADD_REG_TO_REG;break;case"Number":d=h.ADD_IMM_TO_REG;break}break;case v.SUB:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.SUB_REG_FROM_REG;break;case"Number":d=h.SUB_IMM_FROM_REG;break}break;case v.MUL:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.MUL_REG_BY_REG;break;case"Number":d=h.MUL_REG_BY_IMM;break}break;case v.DIV:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.DIV_REG_BY_REG;break;case"Number":d=h.DIV_REG_BY_IMM;break}break;case v.MOD:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.MOD_REG_BY_REG;break;case"Number":d=h.MOD_REG_BY_IMM;break}break;case v.AND:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.AND_REG_WITH_REG;break;case"Number":d=h.AND_REG_WITH_IMM;break}break;case v.OR:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.OR_REG_WITH_REG;break;case"Number":d=h.OR_REG_WITH_IMM;break}break;case v.XOR:switch([f,g]=w([["Register","Register"],["Register","Number"]]),g.type){case"Register":d=h.XOR_REG_WITH_REG;break;case"Number":d=h.XOR_REG_WITH_IMM;break}break;case v.MOV:switch([f,g]=w([["Register","Number"],["Register","Address"],["Address","Register"],["Register","RegisterAddress"],["RegisterAddress","Register"]]),f.type){case"Register":switch(F(g.type!=="Register"),g.type){case"Number":d=h.MOV_IMM_TO_REG;break;case"Address":d=h.MOV_VAL_FROM_ADDR_TO_REG;break;case"RegisterAddress":d=h.MOV_VAL_FROM_REG_ADDR_TO_REG;break}break;case"Address":d=h.MOV_REG_TO_ADDR;break;case"RegisterAddress":d=h.MOV_REG_TO_REG_ADDR}break;case v.CMP:switch([f,g]=w([["Register","Register"],["Register","Number"],["Register","Address"]]),g.type){case"Register":d=h.CMP_REG_WITH_REG;break;case"Number":d=h.CMP_REG_WITH_IMM;break;case"Address":d=h.CMP_REG_WITH_VAL_FROM_ADDR;break}break}o(d),l(f,g);break}}return Xi(t,a,i)},rc=e=>{const t=Ki(e),n=[];for(;t.hasMore();)try{const r=nc(t);if(n.push(r),r.instruction.mnemonic===v.END)break}catch(r){throw r instanceof On?new ws:r}if(n.length>0&&n[n.length-1].instruction.mnemonic!==v.END)throw new ws;return n},ac=e=>{const t={},n=e.length;for(let r=0,a=0;a<n;a++){const o=e[a],{label:i,instruction:l,operands:m,codes:R}=o;if(i!==null){if(i.identifier in t)throw new Pi(i);t[i.identifier]=r}const d=m[0];if(l.mnemonic===v.ORG)F(typeof d?.code=="number"),r=d.code;else if(r+=R.length+(d?.type===Wt.Label?1:0),r>255&&a!==n-1)throw new Fi(o)}return t},oc=e=>{const t=rc(e),n=ac(t),r={},a={},o=t.length;for(let i=0,l=0;l<o;l++){const m=t[l],{instruction:R,operands:d,codes:f}=m,g=d[0];if(R.mnemonic===v.ORG){F(typeof g?.code=="number"),i=g.code;continue}if(g?.type===Wt.Label){if(!(g.value in n))throw new Vi(g);const _=n[g.value]-i;if(_<-128||_>127)throw new Hi(g);const A=$s(_);g.code=A,f.push(A)}const w=i+f.length;f.forEach((_,A)=>{r[i+A]=_}),a[i]=m,i=w}return[r,a]},ic=e=>{let t;try{t=oc(e)}catch(a){if(a instanceof ye){const o=a.toPlainObject();p.dispatch(Ys(o))}else p.dispatch(Se(a)),p.dispatch(Xs());return}const[n,r]=t;p.dispatch(Zs({source:e,addressToStatementMap:r})),p.dispatch(_n(n))},Bn=se(ln,qs,Ut,(e,t,n)=>{const r=t[e];return r&&r.codes.length&&r.codes.every((a,o)=>a===n[e+o])?r.range:null}),Ls={type:ee.Warning,content:"Warning: Source code has changed since last assemble."};class cc{stepIntervalId;interruptIntervalId;isInterruptIntervalSet=!1;lastStep=Promise.resolve(null);dispatchChangesTimeoutId;get willDispatchChanges(){return this.dispatchChangesTimeoutId!==void 0}unsubscribeSetSuspended;lastBreakpointLineNumber;assemble=()=>{ic(p.getState($e))};runOrStop=()=>{this.stopIfRunning()||this.run()};stopIfRunning(){const t=p.getState(Ee);return t&&this.stop(),t}stop(){this.clearStepInterval(),this.isInterruptIntervalSet&&this.clearInterruptInterval(),p.dispatch(rs(!1))}clearStepInterval(){window.clearInterval(this.stepIntervalId)}clearInterruptInterval(t=!0){window.clearInterval(this.interruptIntervalId),t&&(this.isInterruptIntervalSet=!1)}async run(){p.dispatch(rs(!0)),this.setStepInterval();const t=await this.lastStep;t!==null&&us(t.cpuRegisters.sr)&&this.setInterruptInterval(),await this.stepAsync({isUserAction:!0,lastStepResult:t})}setStepInterval(){const{clockSpeed:t}=p.getState(it);this.stepIntervalId=window.setInterval(this.step,1e3/t)}setInterruptInterval(t=!0){const{timerInterval:n}=p.getState(it);this.interruptIntervalId=window.setInterval(()=>{p.dispatch(et(!0))},n),t&&(this.isInterruptIntervalSet=!0)}stopAndRun=()=>{this.pauseMainLoop(),this.resumeMainLoop(),this.step()};pauseMainLoop(){this.clearStepInterval(),this.isInterruptIntervalSet&&this.clearInterruptInterval(!1)}resumeMainLoop(){this.setStepInterval(),this.isInterruptIntervalSet&&this.setInterruptInterval(!1)}step=(t={})=>{this.stepAsync(t)};stepAsync=async({isUserAction:t,lastStepResult:n})=>{n===void 0&&(n=await this.lastStep),t&&p.dispatch(et(!1)),this.stepFrom(n)};stepFrom=t=>{switch(!0){case p.getState($e)!==p.getState(_a):p.dispatch(ht(Ls));break;case p.getState(mt)===Ls:p.dispatch(gt());break}const{fault:n,halted:r}=p.getState(uo);if(n!==null||r){this.stopIfRunning(),n===null&&r&&p.dispatch(ut());return}this.lastStep=new Promise(a=>{let o;try{o=io(t??{memoryData:p.getState(Ut),cpuRegisters:p.getState(ho)},p.getState(Vo))}catch(y){if(this.stopIfRunning(),y instanceof K){const V=y.toPlainObject();p.dispatch(co(V))}else p.dispatch(Se(y));a(null);return}const{memoryData:i,cpuRegisters:l,signals:m,changes:R}=o,d=R.memoryData?.address,f=d!==void 0&&d>=ke,g=()=>{this.cancelDispatchChanges(),this.dispatchChangesTimeoutId=window.setTimeout(()=>{p.dispatch(lo(l)),p.dispatch(Yo(i)),f&&p.dispatch(En(i)),this.dispatchChangesTimeoutId=void 0})};(!this.willDispatchChanges||f)&&g();const w=p.getState(Ee);w&&(R.cpuRegisters?.sr?.interrupt??!1)&&(us(l.sr)?this.isInterruptIntervalSet||this.setInterruptInterval():this.isInterruptIntervalSet&&this.clearInterruptInterval());const{data:_}=m.input,{data:A,expectedInputPort:L}=m.output;if(m.input.interrupt&&p.dispatch(et(!1)),m.output.halted===!0){this.stopIfRunning(),p.dispatch(ut()),a(null);return}m.output.closeWindows===!0&&p.dispatch(Fo());let x=!1;if(L!==void 0)if(p.dispatch(Ss(!0)),_.content===null){switch(x=!0,w&&this.pauseMainLoop(),p.dispatch(Fe(!0)),L){case Tt.SimulatedKeyboard:p.dispatch(Rn(!0));break}this.unsubscribeSetSuspended=N(p.onAction(Fe).pipe(Et()),()=>{w&&this.resumeMainLoop(),this.step()})}else p.dispatch(Es());else p.getState(Ho)&&(p.dispatch(Ss(!1)),p.dispatch(Es()));if(A?.content!==void 0){const{content:y,port:V}=A,M=At(()=>{switch(V){case lt.TrafficLights:return ge.TrafficLights;case lt.SevenSegmentDisplay:return ge.SevenSegmentDisplay}});M!==void 0&&p.dispatch(Sn({name:M,data:y}))}let Y=!1;const S=p.getState(gn);if(S.length&&w&&!x){const y=Rt(p.getState(),M=>{M.cpu.registers=l,M.memory.data=i}),V=Bn(y);if(V){const M=S.find($=>xo($,V));M!==void 0&&(Y=!0,M.number!==this.lastBreakpointLineNumber&&(this.willDispatchChanges||g(),this.stop(),this.lastBreakpointLineNumber=M.number))}}!Y&&this.lastBreakpointLineNumber!==void 0&&this.resetBreakpointLineNumber(),a({memoryData:i,cpuRegisters:l})})};cancelDispatchChanges(){this.dispatchChangesTimeoutId!==void 0&&(window.clearTimeout(this.dispatchChangesTimeoutId),this.dispatchChangesTimeoutId=void 0)}resetBreakpointLineNumber(){this.lastBreakpointLineNumber=void 0}reset=()=>{this.resetSelf(),p.dispatch(cn()),p.dispatch(wn()),p.dispatch(yn())};resetSelf=()=>{this.stopIfRunning(),this.restoreIfSuspended(),this.cancelDispatchChanges(),this.resetBreakpointLineNumber(),this.resetLastStep()};restoreIfSuspended(){p.getState(Me)&&(this.unsubscribeSetSuspended(),p.dispatch(Fe(!1)))}resetLastStep(){this.lastStep=Promise.resolve(null)}}const lc=()=>{const e=Nt(()=>new cc);return E.useEffect(()=>{const t=p.onState(ot);return N(t.pipe(St(ct),P(Boolean)),e.assemble)},[e]),E.useEffect(()=>{const t=p.onAction(fe);return N(t.pipe(Ie(e.resetSelf),P(()=>p.getState(ot)),lr(({isFromFile:n})=>n?dr(ct):ur(null))),e.assemble)},[e]),E.useEffect(()=>{const t=p.onAction(Zs),n=p.onAction(Ys);return N(jt(t,n),e.reset)},[e]),E.useEffect(()=>{const t=p.onState(it);return N(t.pipe(P(()=>p.getState(Ee)&&!p.getState(Me))),e.stopAndRun)},[e]),e},Be=({onClick:e,disabled:t=!1,children:n})=>s.jsx("div",{className:T("flex space-x-2 py-1 px-2 items-center",t?"text-gray-400 fill-gray-400":"hover:bg-gray-200 hover:active:bg-gray-300"),onClick:t?void 0:e,children:n}),dc=()=>{const e=lc(),t=()=>s.jsxs(Be,{onClick:e.assemble,children:[s.jsx(Kr,{}),s.jsx("span",{children:"Assemble"})]}),n=()=>{const o=I(Ee),i=I(Me);return s.jsx(Be,{disabled:i,onClick:e.runOrStop,children:o?s.jsxs(s.Fragment,{children:[s.jsx(sa,{}),s.jsx("span",{children:"Stop"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Us,{}),s.jsxs("span",{children:["Run",Re]})]})})},r=()=>{const o=I(Ee),i=I(Me);return s.jsxs(Be,{disabled:o||i,onClick:e.step.bind(null,{isUserAction:!0}),children:[s.jsx(Xr,{}),s.jsx("span",{children:"Step"})]})},a=()=>s.jsxs(Be,{onClick:e.reset,children:[s.jsx(na,{}),s.jsx("span",{children:"Reset"})]});return s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsx(n,{}),s.jsx(r,{}),s.jsx(a,{})]})},uc=()=>s.jsx(O,{onClick:()=>{p.dispatch(fe({value:Pt.content,isFromFile:!0}))},children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"New File"})]})}),pc=({onFileLoad:e})=>{const t=E.useRef(null),n=i=>{i.stopPropagation(),t.current.click()},r=i=>{i.stopPropagation()},a=i=>{const l=Object.assign(new FileReader,{onload:()=>{F(typeof l.result=="string"),p.dispatch(fe({value:l.result,isFromFile:!0}))}});l.readAsText(i)},o=i=>{const l=i.target.files[0];a(l),e()};return s.jsxs(O,{onClick:n,children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Open..."})]}),s.jsx("input",{ref:t,className:"hidden",type:"file",onChange:o,onClick:r})]})},hc=()=>s.jsx(O.Expandable,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Open Example"})]}),e&&s.jsx(Z.Expanded,{innerRef:t,menuItemElement:n,children:pn.map(({title:r,content:a},o)=>s.jsx(O,{onClick:()=>{p.dispatch(fe({value:a,isFromFile:!0}))},children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:r})]})},o))})]})}),gc=()=>{const e=()=>{const t=p.getState($e),n=new Blob([t],{type:"application/octet-stream"}),r=URL.createObjectURL(n);Object.assign(document.createElement("a"),{download:"file.asm",href:r}).click(),URL.revokeObjectURL(r)};return s.jsx(O,{onClick:e,children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Save As..."})]})})},mc=()=>{const e=t=>{navigator.clipboard.writeText(window.location.href).catch(n=>{t.stopPropagation(),console.error(n)})};return s.jsx(O,{onClick:e,children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Copy Link"})]})})},fc=()=>s.jsx(Ze,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(C.Main,{ref:t,children:[s.jsx(Yr,{}),s.jsx("span",{children:"File"})]}),e&&s.jsxs(Z,{menuElement:n,children:[s.jsx(uc,{}),s.jsx(pc,{onFileLoad:()=>n.click()}),s.jsx(hc,{}),s.jsx(gc,{}),s.jsx(mc,{})]})]})}),Ds=document.getElementById("modal-root"),xc="fixed inset-0 flex items-center justify-center",Jt=({className:e,isOpen:t=!1,children:n})=>{const[r,a]=E.useState(null),o=t&&!!r;return E.useEffect(()=>{if(!t)return;const i=Object.assign(document.createElement("div"),{className:T(xc,e)});return Ds.appendChild(i),a(i),()=>{Ds.removeChild(i),a(null)}},[t,e]),o&&pr.createPortal(n,r)},zt=({href:e,name:t})=>s.jsx(O.ExternalLink,{href:e,children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:t})]})}),bc=()=>s.jsx(zt,{href:"https://nbest.co.uk/Softwareforeducation/sms32v50/sms32v50_manual/250-FullIset.htm",name:"Instruction Set"}),Rc=()=>s.jsx(zt,{href:"https://github.com/exuanbo/assembler-simulator/issues",name:"Report Issue"}),Ec=()=>s.jsx(zt,{href:"https://github.com/exuanbo/assembler-simulator/discussions",name:"Discussions"}),Sc=({onClick:e})=>s.jsx(O,{onClick:e,children:s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"About"})]})}),jc=({isOpen:e,toggleOpen:t})=>{const n=kt(t),r=a=>{a.stopPropagation()};return s.jsx(Jt,{className:"bg-black bg-opacity-20",isOpen:e,children:s.jsxs("div",{ref:n,className:"rounded space-y-2 bg-light-100 shadow text-center py-4 px-8 select-text all:select-text",onClick:r,children:[s.jsx("img",{alt:"icon",className:"mx-auto",height:"72",src:"./pwa-192x192.png",width:"72"}),s.jsx("div",{className:"font-bold",children:"Assembler Simulator"}),s.jsxs("div",{className:"space-y-4 text-sm",children:[s.jsxs("div",{children:[s.jsxs("div",{children:["Version:"," ",s.jsx(le,{href:"https://github.com/exuanbo/assembler-simulator/releases",children:"1.0.0-alpha.40"})]}),s.jsxs("div",{children:["Commit:"," ",s.jsx(le,{href:"https://github.com/exuanbo/assembler-simulator/commits/da72b99",children:"da72b99"})]}),s.jsxs("div",{children:["Date: ","2025-10-19T13:57:35.000Z"]})]}),s.jsxs("div",{children:[s.jsx(le,{href:"https://github.com/exuanbo/assembler-simulator/blob/main/LICENSE",children:"GPL-3.0 License"})," ",s.jsx("span",{className:"font-sans",children:"©"})," 2022-Present"," ",s.jsx(le,{href:"https://github.com/exuanbo",children:"Exuanbo"})]})]})]})})},yc=()=>{const[e,t]=Ct(!1);return s.jsx(Ze,{children:(n,r,a)=>s.jsxs(s.Fragment,{children:[s.jsx(C.Main,{ref:r,children:s.jsx(Qr,{})}),n&&s.jsxs(Z,{menuElement:a,children:[s.jsx(bc,{}),s.jsx(Rc,{}),s.jsx(Ec,{}),s.jsx(Sc,{onClick:t})]}),s.jsx(jc,{isOpen:e,toggleOpen:t})]})})},vc=()=>{const e=I(In);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Memory"})]}),t&&s.jsx(Z.Expanded,{innerRef:n,menuItemElement:r,children:zo.map((a,o)=>s.jsx(O,{onClick:()=>{p.dispatch(Xo(a))},children:s.jsxs(C,{children:[e===a?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},_c=()=>{const e=I($o);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(C,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"I/O Devices"})]}),t&&s.jsx(Z.Expanded,{innerRef:n,menuItemElement:r,children:bn.map((a,o)=>s.jsx(O,{onClick:()=>{p.dispatch(jn(a))},children:s.jsxs(C,{children:[e[a].isVisible?s.jsx(je,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:ca(a)})]})},o))})]})})},wc=()=>s.jsx(Ze,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(C.Main,{ref:t,children:[s.jsx(ra,{}),s.jsx("span",{children:"View"})]}),e&&s.jsxs(Z,{menuElement:n,children:[s.jsx(vc,{}),s.jsx(_c,{})]})]})}),Ic=()=>{const[e,t]=E.useState(null),n=va(i=>{t(i),o(i)}),r=E.useMemo(()=>({currentOpen:e,setCurrentOpen:n}),[e,n]),a=E.useCallback(()=>{n(null)},[n]),o=kt(a);return s.jsxs("header",{className:"border-y flex flex-row-reverse min-w-max bg-gray-100 h-8 w-full z-10 fixed items-center justify-between",children:[s.jsxs("div",{className:"flex space-x-2 py-1 px-2 items-center",children:[s.jsx("h1",{children:"Assembler Simulator"}),s.jsx(le,{href:"https://github.com/exuanbo/assembler-simulator",children:s.jsx(qr,{width:"1.125rem"})})]}),s.jsx("div",{className:"divide-x border-r flex",children:s.jsxs(An.Provider,{value:r,children:[s.jsx(fc,{}),s.jsx(wc,{}),s.jsx(Ii,{}),s.jsx(dc,{}),s.jsx(yc,{})]})})]})},Xe=({title:e,onClick:t,children:n})=>{const r=t!==void 0;return s.jsxs("header",{className:T("border-b flex space-x-2 bg-gray-100 py-1 px-2 items-center justify-between",{"cursor-pointer":r}),onClick:t,children:[s.jsx("span",{children:e}),n]})};var Ve=(e=>(e.Hex="hex",e.Bin="bin",e.Dec="dec",e))(Ve||{});const Lc=({label:e,value:t,valueClassName:n})=>s.jsx("td",{className:"px-1",children:s.jsxs("div",{className:"flex space-x-1 items-center justify-center",children:[s.jsx("span",{className:"rounded bg-gray-100 text-xs px-1 text-gray-400",children:e}),s.jsx("span",{className:T("rounded text-sm px-1",n),children:t})]})}),Dc=()=>s.jsx("td",{className:"px-1",children:s.jsxs("div",{className:"flex space-x-1 items-center justify-center",children:[s.jsx("span",{className:"text-xs px-1",children:Re.repeat(3)}),s.jsx("span",{className:"text-sm px-1",children:`${Re.repeat(3)}ISOZ${Re}`})]})}),He=Object.assign(Lc,{FlagIndicator:Dc}),Mc=({name:e,value:t,valueClassName:n})=>{const r=Q(t),a=Ws(t),o=q(t),i=`${o>=0?"+":"-"}${`${Math.abs(o)}`.padStart(3,"0")}`;return s.jsxs("tr",{className:"divide-x",children:[s.jsx("td",{className:"bg-gray-50 text-center px-2",children:e}),s.jsx(He,{label:Ve.Hex,value:r,valueClassName:n}),s.jsx(He,{label:Ve.Bin,value:a}),s.jsx(He,{label:Ve.Dec,value:i})]})},Ac=()=>s.jsxs("tr",{children:[s.jsx("td",{children:Re}),s.jsx("td",{}),s.jsx(He.FlagIndicator,{}),s.jsx("td",{})]}),re=Object.assign(Mc,{FlagIndicator:Ac}),Cc=()=>{const e=I(ue(ze)(H.AL));return s.jsx(re,{name:Ne.AL,value:e})},Nc=()=>{const e=I(ue(ze)(H.BL));return s.jsx(re,{name:Ne.BL,value:e})},kc=()=>{const e=I(ue(ze)(H.CL));return s.jsx(re,{name:Ne.CL,value:e})},Oc=()=>{const e=I(ue(ze)(H.DL));return s.jsx(re,{name:Ne.DL,value:e})},Tc=()=>{const e=I(ln);return s.jsx(re,{name:Je.IP,value:e,valueClassName:"bg-green-100"})},Gc=()=>{const e=I(go);return s.jsx(re,{name:Je.SP,value:e,valueClassName:"bg-blue-100"})},Bc=()=>{const e=I(fo);return s.jsx(re,{name:Je.SR,value:e})},Pc=()=>s.jsxs("div",{className:"border-b",children:[s.jsx(Xe,{title:"Registers"}),s.jsxs("div",{className:"divide-x flex",children:[s.jsx("table",{className:"flex-1",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsx(Cc,{}),s.jsx(Nc,{}),s.jsx(kc,{}),s.jsx(Oc,{})]})}),s.jsx("table",{className:"flex-1",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsx(Tc,{}),s.jsx(Gc,{}),s.jsx(Bc,{}),s.jsx(re.FlagIndicator,{})]})})]})]}),Ae=e=>{const t={isJust:()=>!0,isNothing:()=>!1,map:n=>Ae(n(e)),alt:()=>t,altLazy:()=>t,chain:n=>n(e),orDefault:()=>e,orDefaultLazy:()=>e,filter:n=>n(e)?t:z,extract:()=>e,extractNullable:()=>e,ifJust:n=>(n(e),t),ifNothing:()=>t};return t},z={isJust:()=>!1,isNothing:()=>!0,map:()=>z,alt:e=>e,altLazy:e=>e(),chain:()=>z,orDefault:e=>e,orDefaultLazy:e=>e(),filter:()=>z,extract:()=>{},extractNullable:()=>null,ifJust:()=>z,ifNothing:e=>(e(),z)},Kt=e=>e!=null?Ae(e):z,Fc=e=>e?Ae(e):z,Pn=hr.define(),Vc=e=>t=>{const{annotations:n=[]}=t;return{...t,annotations:[...[n].flat(),Pn.of(e)]}},Hc=e=>t=>t.annotation(Pn)===e;var G=(e=>(e.Breakpoint="cm-breakpoint",e.ActiveLine="cm-activeLine",e.ActiveLineGutter="cm-activeLineGutter",e.HighlightLineDefault="cm-highlightLine",e.HighlightLineTransparent="cm-highlightLine--transparent",e.WavyUnderline="cm-wavyUnderline",e))(G||{}),B=(e=>(e.Cursor="cm-cursor",e.CursorPrimary="cm-cursor-primary",e.Focused="cm-focused",e.Scroller="cm-scroller",e.Gutters="cm-gutters",e.GutterElement="cm-gutterElement",e.SelectionMatch="cm-selectionMatch",e.LineNumbers="cm-lineNumbers",e))(B||{});const qe=yt.define({map(e,t){return{pos:t.mapPos(e.pos),on:e.on}}});class Zt extends Ps{eq(t){return t instanceof Zt}toDOM(){return document.createTextNode("●")}}const Fn=new Zt,Vn=vt.define({create(){return st.empty},update(e,t){const n=e.map(t.changes);return _t(t.effects,qe).reduce((r,a)=>wt(a,({pos:o,on:i})=>r.update(i?{add:[Fn.range(o)]}:{filter:l=>l!==o})),n)}}),Ce=e=>e.field(Vn),Uc=(e,t)=>{let n=!1;Ce(e.state).between(t,t,()=>{n=!0}),e.dispatch({effects:qe.of({pos:t,on:!n})})},Hn=(e,t,n)=>(F(n instanceof MouseEvent),F(n.target instanceof Element),n.offsetY>t.bottom||n.target.classList.contains(G.Breakpoint)?!1:(Uc(e,t.from),!0)),$c=()=>[Vn,gr({class:G.Breakpoint,markers:e=>Ce(e.state),initialSpacer:()=>Fn,domEventHandlers:{mousedown:Hn}}),U.baseTheme({[`.${G.Breakpoint}`]:{fontSize:"0.875em"},[`.${G.Breakpoint} .${B.GutterElement}`]:{width:"20px",padding:"0 3px 0 5px",color:"red !important",cursor:"pointer"}})],xt=yt.define({map({pos:e,filter:t},n){return{pos:e.map(r=>n.mapPos(r)),filter:t}}}),Ms=te.line({class:G.HighlightLineDefault}),As=te.line({class:G.HighlightLineTransparent}),Wc=vt.define({create(){return te.none},update(e,t){const n=e.map(t.changes),r=mr(n,(a,o,i)=>{const m=t.selection!==void 0&&fs(t.state.doc.lineAt(i),t.selection.ranges)?As:Ms;return o.eq(m)?a:a.update({add:[m.range(i)],filter:R=>R!==i})},n);return _t(t.effects,xt).reduce((a,o)=>wt(o,({pos:i,filter:l})=>a.update({add:i.map(m=>[(fs(t.state.doc.lineAt(m),t.state.selection.ranges)?As:Ms).range(m)]).extract(),filter:l})),r)},provide:e=>U.decorations.from(e)}),Jc=()=>[Wc,U.baseTheme({[`.${G.HighlightLineDefault}`]:{backgroundColor:"#dcfce7 !important"},[`.${G.HighlightLineTransparent}`]:{backgroundColor:"#dcfce780 !important"}})],Un=e=>new fr(t=>Fs(e,n=>{t.next(n)})),zc=(e,t)=>({changes:{from:0,to:e.doc.length,insert:t}}),Kc="modulepreload",Zc=function(e,t){return new URL(e,t).href},Cs={},$n=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){let R=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),m=l?.nonce||l?.getAttribute("nonce");a=R(n.map(d=>{if(d=Zc(d,r),d in Cs)return;Cs[d]=!0;const f=d.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(r)for(let _=i.length-1;_>=0;_--){const A=i[_];if(A.href===d&&(!f||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${g}`))return;const w=document.createElement("link");if(w.rel=f?"stylesheet":Kc,f||(w.as="script"),w.crossOrigin="",w.href=d,m&&w.setAttribute("nonce",m),document.head.appendChild(w),f)return new Promise((_,A)=>{w.addEventListener("load",_),w.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})},bt=new xr(null);function Yc(e){return br($n(()=>import("./index-CqQMKfWi.js"),__vite__mapDeps([0,1,2]),import.meta.url)).pipe(k(({vim:t})=>t({status:!0})),Ie(t=>bt.next(t)),Ie(t=>Rr(e,t)))}function Xc(e){return bt.pipe(P(Boolean),Ie(()=>bt.next(null)),Ie(t=>Er(e,t)))}const Wn=yt.define({map({range:e,filter:t},n){return{range:e.map(({from:r,to:a})=>({from:n.mapPos(r),to:n.mapPos(a)})),filter:t}}}),qc=te.mark({class:G.WavyUnderline}),Qc=vt.define({create(){return te.none},update(e,t){const n=e.map(t.changes);return _t(t.effects,Wn).reduce((r,a)=>wt(a,({range:o,filter:i})=>r.update({add:o.map(({from:l,to:m})=>[qc.range(l,m)]).extract(),filter:i})),n)},provide:e=>U.decorations.from(e)}),el=`url('data:image/svg+xml;base64,${window.btoa(`<svg height="4" width="6" xmlns="http://www.w3.org/2000/svg">
  <path fill="none" stroke="red" d="m0 3 l2 -2 l1 0 l2 2 l1 0" />
</svg>`)}')`,tl=()=>[Qc,U.baseTheme({[`.${G.WavyUnderline}`]:{background:`${el} left bottom repeat-x`,paddingBottom:"2px"}})],sl=se([Bn,(e,t)=>t.state.doc],(e,t)=>Kt(e).chain(n=>{const r=[],a=Math.min(n.to,t.length);for(let o=n.from;o<a;o++){const i=t.lineAt(o);r.includes(i.from)||r.push(i.from)}return Fc(r.length&&r)})),nl=W(e=>{const t=Un(e);return N(t.pipe(P(n=>n.docChanged),k(()=>Xs())),n=>p.dispatch(n))}),Jn=Vc("SyncFromState"),zn=Hc("SyncFromState"),rl=W(e=>{const t=Un(e);return N(t.pipe(P(n=>n.docChanged),St(ct),P(n=>{const r=n.transactions[0];return!r||!zn(r)}),k(n=>n.state.doc.toString()),k(n=>fe({value:n}))),n=>p.dispatch(n))}),al=W(e=>{const t=p.onAction(fe);return N(t.pipe(P(({value:n})=>n!==e.state.doc.toString()),k(({value:n})=>zc(e.state,n)),k(n=>Jn(n))),n=>e.dispatch(n))}),ol=W(e=>{const t=p.onAction(fe);return N(t.pipe(P(({isFromFile:n})=>n),P(({value:n})=>wo(n)),k(()=>({selection:Io}))),n=>(e.focus(),e.dispatch(n)))}),il=W(e=>{const t=p.onState(Ia);return N(t.pipe(k(Kt),k(n=>Wn.of({range:n,filter:()=>n.isJust()})),k(n=>({effects:n}))),n=>e.dispatch(n))}),cl=W(e=>{const t=p.onState(ue(sl)(e));return N(t,n=>{n.map(r=>r.map((a,o)=>xt.of({pos:Ae(a),filter:()=>o!==0}))).altLazy(()=>Ae([xt.of({pos:z,filter:()=>!1})])).map(r=>({effects:r})).ifJust(r=>e.dispatch(r)),n.filter(()=>!e.hasFocus).map(r=>({selection:{anchor:r[0]},scrollIntoView:!0})).ifJust(r=>e.dispatch(r))})}),ll=W(e=>Fs(e,t=>{if(t.docChanged){const n=Ce(t.state);if(!Sr(n,Ce(t.startState))){const r=jr(n,(a,o)=>pt(t.state.doc,o));p.dispatch(hn(r))}}else{const n=t.transactions[0];if(!n||zn(n))return;n.effects.forEach(r=>{if(r.is(qe)){const a=r.value.on?Mo:Ao,o=pt(t.state.doc,r.value.pos);p.dispatch(a(o))}})}})),dl=W(e=>{const t=p.getState(gn),n=t.filter(a=>a.to<=e.state.doc.length&&dn(a,pt(e.state.doc,a.from)));if(n.length<t.length&&p.dispatch(hn(n)),n.length===0)return;Ce(e.state).size===0&&e.dispatch(Jn({effects:n.map(a=>qe.of({pos:a.from,on:!0}))}))}),ul=W(e=>{const t=p.onState(Qs);return N(t.pipe(k(n=>n?Yc:Xc),It(n=>n(e))))}),pl=[nl,rl,al,ol,il,cl,ll,dl,ul],hl=W(e=>{const t=pl.map(n=>n(e));return()=>t.forEach(n=>n?.())}),gl=U.exceptionSink,ml=e=>gl.of(e),X={SKIPABLE_CHARACTER:/[,[\]:]/,LABEL_DECLARATION:/^[a-zA-Z_]+(?=:)/,LABEL_REFERENCE:/^[a-zA-Z_]+/,NUMBER:/^[\da-fA-F]+\b/,REGISTER:/^[a-dA-D][lL]\b/,STRING:/^"(?:(?:[^\\]|\\.)*?"|.*)/,UNKNOWN:/^[^\s;:,["]+/,NON_WHITESPACE:/^\S+/},fl=()=>({ended:!1,operandsLeft:0,expectingLabel:!1}),xl=yr.define({name:"asm",startState:fl,token(e,t){if(t.ended)return e.skipToEnd(),"comment";if(e.eatSpace()||e.eat(X.SKIPABLE_CHARACTER))return null;if(e.eat(";"))return e.skipToEnd(),"comment";if(e.match(X.LABEL_DECLARATION))return t.operandsLeft=0,"labelName";if(t.operandsLeft){if(e.match(X.NUMBER))return t.operandsLeft-=1,"number";if(e.match(X.REGISTER))return t.operandsLeft-=1,"variableName.special";if(e.match(X.STRING))return t.operandsLeft-=1,"string";if(t.expectingLabel&&e.match(X.LABEL_REFERENCE))return t.operandsLeft-=1,t.expectingLabel=!1,"labelName";t.operandsLeft=0}else if(e.match(X.UNKNOWN)){const n=e.current().toUpperCase();if(Dt(n,v)){const r=n;return r===v.END&&(t.ended=!0),t.operandsLeft=en[r],t.expectingLabel=r.startsWith("J"),"keyword"}else return null}return e.match(X.NON_WHITESPACE),null},indent(e,t,n){const{selection:r,tabSize:a}=n.state,o=r.main.from,l=(n.lineAt(o,-1).text.match(/^\s+/)?.[0]??"").replace(new RegExp(` {${a}}`,"g"),"	").replace(/ +(?=\t)/g,"").split(""),m=l.reduce((d,f)=>f==="	"?d+1:d,0),R=l.length-m;return m*a+R},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["[",'"']}}}),bl=()=>[new vr(xl,[wr.of("	")]),_r(Ir)],Rl=te.line({class:G.ActiveLine}),El=Lr.fromClass(class{_decorations;get decorations(){return this._decorations}constructor(t){this._decorations=this.getDecorations(t)}update(t){(t.docChanged||t.selectionSet)&&(this._decorations=this.getDecorations(t.view))}getDecorations(t){const n=t.state.selection.ranges;if(n.some(o=>!o.empty))return te.none;const r=[],a=n.length;for(let o=-1,i=0;i<a;i++){const l=n[i],m=t.state.doc.lineAt(l.head);m.from>o&&(r.push(Rl.range(m.from)),o=m.from)}return te.set(r)}},{decorations:e=>e.decorations}),Sl=()=>[El,U.baseTheme({[`&.${B.Focused} .${G.ActiveLine}`]:{boxShadow:"inset 0 0 0 2px #e5e7eb"},[`.${G.ActiveLine}`]:{backgroundColor:"unset"}})];class jl extends Ps{elementClass=G.ActiveLineGutter}const yl=new jl,vl=Dr.compute(["selection"],e=>{const t=e.selection.ranges;if(t.some(a=>!a.empty))return st.empty;const n=[],r=t.length;for(let a=-1,o=0;o<r;o++){const i=t[o],l=e.doc.lineAt(i.head);l.from>a&&(n.push(yl.range(l.from)),a=l.from)}return st.of(n)}),_l=()=>[vl,U.baseTheme({[`&.${B.Focused} .${G.ActiveLineGutter}`]:{color:"#4b5563"},[`.${G.ActiveLineGutter}`]:{backgroundColor:"unset"}})],wl=()=>[U.baseTheme({[`.${B.SelectionMatch}`]:{backgroundColor:"#bdcfe480"}}),Mr()],Il={key:"Tab",run:Cr,shift:Ar},Ll=(e,t,n)=>(F(n.target instanceof Element),n.target.classList.contains(B.GutterElement)?Hn(e,t,n):!1),Dl=()=>[Nr({domEventHandlers:{mousedown:Ll}}),U.baseTheme({[`.${B.LineNumbers}`]:{paddingRight:"6px"},[`.${B.LineNumbers} .${B.GutterElement}`]:{cursor:"pointer"}})],Ml=()=>U.theme({"&":{height:"100%"},[`&.${B.Focused}`]:{outline:"0"},[`.${B.Scroller}`]:{cursor:"text",fontFamily:"'Jetbrains Mono', monospace"},[`.${B.Gutters}`]:{borderRight:"1px solid #e5e7eb",backgroundColor:"#f3f4f6",cursor:"initial",color:"#9ca3af"},[`.${B.Cursor}`]:{borderLeft:"2px solid black"},[`&:not(.${B.Focused}) .${B.CursorPrimary}`]:{outline:"0 !important"}}),Al=()=>[kr(),Or(),Tr(),Gr(),Br(),Ml(),bl(),Sl(),wl(),_l(),$c(),Dl(),tl(),Jc(),Pr.of([...Fr,...Vr,...Hr,Il])],{useViewEffect:Cl,setContainer:Nl}=Ur(e=>{const t=p.getState($e),n=r=>{p.dispatch(Se(r))};return{state:e,doc:t,extensions:[Al(),ml(n)]}}),kl=2e3,Ns={type:ee.Info,content:"Info: Program has halted."},Ol=e=>({type:ee.Error,content:`${e.name}: ${e.message}`}),Tl=()=>{const e=I(wa),t=I(po),n=e??t,r=I(mt);return E.useEffect(()=>{const a=p.onState(mt),o=p.onAction(ut),i=p.onAction(cn);return N(jt(o.pipe(k(()=>ht(Ns))),i.pipe(It(()=>a.pipe(Et())),P(l=>l===Ns),k(()=>gt()))),l=>p.dispatch(l))},[]),E.useEffect(()=>{const a=p.onAction(ht);return N(a.pipe(St(kl),P(Boolean),P(({type:o})=>o!==ee.Error),k(()=>gt())),o=>p.dispatch(o))},[]),Kt(n).map(Ol).orDefault(r)},Gl=({className:e})=>(Cl(hl),s.jsx("div",{ref:Nl,className:T("cursor-auto select-auto overflow-y-auto",e)})),Bl=e=>{switch(e){case ee.Error:return"bg-red-500";case ee.Warning:return"bg-yellow-500";case ee.Info:return"bg-blue-500"}},Pl=()=>{const e=Tl();return e?s.jsx("div",{className:T("py-1 px-2 text-light-100",Bl(e.type)),children:e.content}):null},Fl=()=>s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsx(Gl,{className:"flex-1"}),s.jsx(Pl,{})]});class Vl extends E.Component{componentDidCatch(t){this.props.onError(t)}render(){return this.props.children}}const Hl=({children:e})=>{const t=E.useCallback(n=>{p.dispatch(Se(n))},[]);return s.jsx(Vl,{onError:t,children:e})},Ul=()=>{const e=I(ko),t=e!==null,n=E.useCallback(()=>{p.dispatch(No())},[]),r=kt(n);return s.jsx(Jt,{className:"bg-white bg-opacity-80 z-50",isOpen:t,children:s.jsxs("div",{ref:r,className:"border rounded space-y-2 bg-light-100 shadow py-2 px-4 select-text all:select-text",children:[t&&e.stack?.split(/\n(.*)/s).slice(0,-1).map((a,o)=>o===0?s.jsx("div",{children:a.split(": ").map((l,m)=>{const R=m===0;return s.jsx("div",{className:R?"text-xl text-red-500":"border-b text-lg py-1",children:l},m)})},o):s.jsx("div",{className:"rounded bg-red-50 py-2 px-5.5 text-gray-600 whitespace-pre-line",children:a},o)),s.jsxs("div",{children:["Please report this bug at"," ",s.jsx(le,{href:"https://github.com/exuanbo/assembler-simulator/issues",children:"https://github.com/exuanbo/assembler-simulator/issues"}),"."]})]})})},$l=()=>{E.useEffect(()=>{const e=n=>{p.dispatch(Se(n.error))},t=n=>{p.dispatch(Se(n.reason))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[])},Yt=({name:e,onClose:t,className:n,children:r})=>{const a=t!==void 0;return s.jsxs("div",{className:"border shadow m-1",children:[s.jsx(Xe,{title:e,children:a&&s.jsx("span",{className:"rounded-full flex bg-gray-200 h-4 w-4 justify-center group hover:active:bg-gray-300",onClick:t,children:s.jsx(Zr,{className:"fill-none group-hover:fill-gray-400",width:"0.5rem"})})}),s.jsx("div",{className:T("p-1",n),children:r})]})},Xt=e=>{const t=E.useMemo(()=>ue(Wo)(e),[e]),n=I(t),r=E.useCallback(i=>{const l=p.onState(t);return N(l,i)},[t]),a=I(E.useMemo(()=>ue(Jo)(e),[e])),o=E.useCallback(()=>{p.dispatch(jn(e))},[e]);return E.useEffect(()=>{if(a)return;const i=p.onAction(Sn);return N(i.pipe(P(({name:l})=>l===e)),o)},[e,a,o]),{data:n,subscribeData:r,isVisible:a,toggleVisible:o}},Wl=s.jsxs(s.Fragment,{children:[s.jsx("rect",{fill:"#a1a1aa",height:"300",width:"320",children:s.jsx("title",{children:"Background"})}),s.jsxs("g",{fill:"#000",children:[s.jsx("title",{children:"Screen"}),s.jsx("rect",{height:"128",width:"80",x:"40",y:"56"}),s.jsx("rect",{height:"128",width:"80",x:"192",y:"56"})]}),s.jsxs("g",{fill:"none",stroke:"#fff",strokeWidth:"2",children:[s.jsx("title",{children:"Circut"}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 0"}),s.jsx("polyline",{points:"100,260 100,248 20,248 20,40 232,40 232,64"}),s.jsx("line",{x1:"80",x2:"80",y1:"40",y2:"64"}),s.jsx("line",{x1:"56",x2:"104",y1:"64",y2:"64"}),s.jsx("line",{x1:"208",x2:"256",y1:"64",y2:"64"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 1"}),s.jsx("polyline",{points:"116,260 116,240 28,240 28,48 188,48 188,92 204,92"}),s.jsx("line",{x1:"28",x2:"52",y1:"92",y2:"92"}),s.jsx("line",{x1:"52",x2:"52",y1:"68",y2:"116"}),s.jsx("line",{x1:"204",x2:"204",y1:"68",y2:"116"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 2"}),s.jsx("polyline",{points:"132,260 132,232 36,232 36,148 52,148"}),s.jsx("polyline",{points:"132,232 208,232 208,192 188,192 188,148 204,148"}),s.jsx("line",{x1:"52",x2:"52",y1:"124",y2:"172"}),s.jsx("line",{x1:"204",x2:"204",y1:"124",y2:"172"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 3"}),s.jsx("polyline",{points:"148,260 148,224 80,224 80,176"}),s.jsx("polyline",{points:"148,224 232,224 232,176"}),s.jsx("line",{x1:"56",x2:"104",y1:"176",y2:"176"}),s.jsx("line",{x1:"208",x2:"256",y1:"176",y2:"176"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 4"}),s.jsx("polyline",{points:"164,260 164,216 124,216 124,148 108,148"}),s.jsx("polyline",{points:"164,216 276,216 276,148 260,148"}),s.jsx("line",{x1:"108",x2:"108",y1:"124",y2:"172"}),s.jsx("line",{x1:"260",x2:"260",y1:"124",y2:"172"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 5"}),s.jsx("polyline",{points:"180,260 180,208 132,208 132,120 56,120"}),s.jsx("polyline",{points:"180,208 284,208 284,120 208,120"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 6"}),s.jsx("polyline",{points:"196,260 196,200 140,200 140,92 108,92"}),s.jsx("polyline",{points:"196,200 292,200 292,92 260,92"}),s.jsx("line",{x1:"108",x2:"108",y1:"68",y2:"116"}),s.jsx("line",{x1:"260",x2:"260",y1:"68",y2:"116"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 7"}),s.jsx("polyline",{points:"212,260 212,240 300,240 300,24 204,24"}),s.jsxs("g",{fill:"#a1a1aa",children:[s.jsx("title",{children:"Inverter"}),s.jsx("polygon",{points:"204,24 204,14 194,24 204,34 204,24"}),s.jsx("circle",{cx:"190",cy:"24",r:"2"})]}),s.jsx("polyline",{points:"188,24 118,24 118,56"}),s.jsx("line",{x1:"270",x2:"270",y1:"24",y2:"56"})]})]}),s.jsxs("g",{fill:"#fff",children:[s.jsx("title",{children:"Circut Node"}),de(8).map(e=>s.jsx("rect",{height:"8",width:"8",x:96+e*16,y:"260"},e)),de(5).map(e=>s.jsx("rect",{height:"4",width:"8",x:128+e*16,y:230-e*8},e)),s.jsx("rect",{height:"4",width:"8",x:"76",y:"38"}),s.jsx("rect",{height:"4",width:"8",x:"24",y:"90"}),s.jsx("rect",{height:"4",width:"8",x:"266",y:"22"}),s.jsx("rect",{height:"8",width:"8",x:"266",y:"54"}),s.jsx("rect",{height:"8",width:"8",x:"114",y:"54"})]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Label"}),s.jsx("text",{x:"60",y:"270",children:"MSB"}),s.jsx("text",{x:"252",y:"270",children:"LSB"})]})]}),Jl=[s.jsx("polygon",{points:"56,64 104,64 96,72 64,72"},0),s.jsx("polygon",{points:"208,64 256,64 248,72 216,72"},1),s.jsx("polygon",{points:"52,68 60,76 60,108 52,116"},2),s.jsx("polygon",{points:"204,68 212,76 212,108 204,116"},3),s.jsx("polygon",{points:"52,124 60,132 60,164 52,172"},4),s.jsx("polygon",{points:"204,124 212,132 212,164 204,172"},5),s.jsx("polygon",{points:"56,176 64,168 96,168 104,176"},6),s.jsx("polygon",{points:"208,176 216,168 248,168 256,176"},7),s.jsx("polygon",{points:"108,124 108,172 100,164 100,132"},8),s.jsx("polygon",{points:"260,124 260,172 252,164 252,132"},9),s.jsx("polygon",{points:"56,120 60,116 100,116 104,120 100,124 60,124"},10),s.jsx("polygon",{points:"208,120 212,116 252,116 256,120 252,124 212,124"},11),s.jsx("polygon",{points:"108,68 108,116 100,108 100,76"},12),s.jsx("polygon",{points:"260,68 260,116 252,108 252,76"},13)],Kn=14,ks=new Array(Kn).fill(0),zl=()=>{const[e,t]=E.useState(ks);E.useEffect(()=>{const l=p.onAction(yn);return N(l.pipe(k(()=>ks)),t)},[]);const{data:n,subscribeData:r,isVisible:a,toggleVisible:o}=Xt(ge.SevenSegmentDisplay),i=l=>{t(m=>Rt(m,R=>{const d=l[l.length-1];for(let f=d;f<Kn;f+=2)R[f]=l[Math.floor(f/2)]}))};return E.useEffect(()=>r(i),[r]),a?s.jsx(Yt,{name:"Seven-segment Display",onClose:o,children:s.jsxs("svg",{viewBox:"0 0 320 300",width:"320",xmlns:"http://www.w3.org/2000/svg",children:[s.jsxs("g",{children:[s.jsx("title",{children:"Static Layer"}),Wl]}),s.jsxs("g",{fill:"lime",stroke:"lime",strokeWidth:"2",children:[s.jsx("title",{children:"Segments Layer"}),Jl.filter((l,m)=>!!e[m])]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Data Layer"}),n.map((l,m)=>s.jsx("text",{x:100+m*16,y:"284",children:l},m))]})]})}):null},Os=3,Kl=250,Zl=()=>{const[e,t]=E.useState(1);return E.useEffect(()=>{const n=window.setInterval(()=>t(r=>(r+1)%(Os+1)),Kl);return()=>window.clearInterval(n)},[]),s.jsx("span",{className:"inline-block my-auto",children:de(Os).map(n=>s.jsx("span",{className:T({invisible:n>=e}),children:"."},n))})},Yl=()=>{const e=I(Me),t=I(Uo),n=e&&t,r=E.useRef(null),a=()=>{window.setTimeout(()=>{r.current?.focus()})},o=m=>{p.dispatch(Po({content:m,port:Tt.SimulatedKeyboard})),p.dispatch(Fe(!1)),p.dispatch(Rn(!1))},i=m=>{switch(m.key){case"Backspace":o(we.BS);break;case"Tab":m.preventDefault(),o(we.TAB);break;case"Enter":o(we.CR);break;case"Escape":o(rn);break}},l=m=>{const R=m.target.value;o(R.charCodeAt(0))};return s.jsxs(Jt,{className:"bg-black bg-opacity-20 animate-fade-in animate-duration-250",isOpen:n,children:[s.jsxs("div",{className:"rounded bg-light-100 shadow py-4 px-8",children:["Waiting for keyboard input ",s.jsx(Zl,{})]}),s.jsx("input",{ref:r,autoFocus:!0,className:"-z-1 absolute",onBlur:a,onChange:l,onKeyDown:i})]})},Xl=s.jsxs(s.Fragment,{children:[s.jsx("rect",{fill:"#a1a1aa",height:"120",width:"320",x:"0",y:"120",children:s.jsx("title",{children:"Background"})}),s.jsxs("g",{fill:"#000",children:[s.jsx("title",{children:"Pillar"}),s.jsx("rect",{height:"112",width:"48",x:"32",y:"24"}),s.jsx("rect",{height:"80",width:"16",x:"48",y:"136"}),s.jsx("rect",{height:"12",width:"32",x:"40",y:"216"}),s.jsx("rect",{height:"112",width:"48",x:"232",y:"24"}),s.jsx("rect",{height:"80",width:"16",x:"248",y:"136"}),s.jsx("rect",{height:"12",width:"32",x:"240",y:"216"})]}),s.jsxs("g",{fill:"none",stroke:"#fff",strokeWidth:"2",children:[s.jsx("title",{children:"Circut"}),s.jsx("polyline",{points:"44,44 36,44 36,132 52,132 52,180 100,180 100,200"}),s.jsx("polyline",{points:"44,76 40,76 40,128 56,128 56,176 116,176 116,200"}),s.jsx("polyline",{points:"68,108 72,108 72,132 60,132 60,172 132,172 132,200"}),s.jsx("polyline",{points:"244,44 236,44 236,132 252,132 252,172 148,172 148,200"}),s.jsx("polyline",{points:"244,76 240,76 240,128 256,128 256,176 164,176 164,200"}),s.jsx("polyline",{points:"268,108 272,108 272,132 260,132 260,180 180,180 180,200"}),s.jsx("polyline",{points:"196,200 196,184 276,184 276,160"}),s.jsx("polyline",{points:"212,200 212,188 280,188 280,164"})]}),s.jsxs("g",{fill:"#fff",children:[s.jsx("title",{children:"Circut Node"}),de(8).map(e=>s.jsx("rect",{height:"8",width:"8",x:96+e*16,y:"200"},e))]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Label"}),s.jsx("text",{x:"24",y:"210",children:"MSB"}),s.jsx("text",{x:"288",y:"210",children:"LSB"})]})]}),ql=["red","yellow","lime"],Ql=()=>{const{data:e,isVisible:t,toggleVisible:n}=Xt(ge.TrafficLights);return t?s.jsx(Yt,{name:"Traffic Lights",onClose:n,children:s.jsxs("svg",{viewBox:"0 0 312 240",width:"312",xmlns:"http://www.w3.org/2000/svg",children:[s.jsxs("g",{children:[s.jsx("title",{children:"Static Layer"}),Xl]}),s.jsxs("g",{children:[s.jsx("title",{children:"Lights Layer"}),de(6).map(r=>{const a=!!e[r];return s.jsx("circle",{cx:r<3?56:256,cy:44+r%3*32,fill:a?ql[r%3]:"none",r:"12"},r)})]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Data Layer"}),e.map((r,a)=>s.jsx("text",{x:100+a*16,y:"224",children:r},a))]})]})}):null},ed=()=>{const{data:e,isVisible:t,toggleVisible:n}=Xt(ge.VisualDisplayUnit);return E.useEffect(()=>{const r=p.onAction(_n),a=p.onAction(wn),o=p.onState(Ut);return N(jt(r,a).pipe(It(()=>o.pipe(Et())),k(En)),i=>p.dispatch(i))},[]),t?s.jsx(Yt,{className:"flex flex-col space-y-1",name:"Visual Display Unit",onClose:n,children:Mt(16,Ra(e)).map((r,a)=>s.jsx("div",{className:"flex space-x-1",children:r.map((o,i)=>s.jsx("div",{className:"bg-gray-200 text-center w-4.5",children:o===" "?Re:o},i))},a))}):null},td=()=>{const[e,t]=Ct(!0),n=e?Hs:Vs;return s.jsxs("div",{children:[s.jsx(Xe,{title:"I/O Devices",onClick:t,children:s.jsx("span",{className:"w-4",children:s.jsx(n,{className:"mx-auto fill-gray-400",width:"0.625rem"})})}),s.jsx(Yl,{}),e&&s.jsxs("div",{className:"flex flex-wrap py-1 px-1 items-start",children:[s.jsx(ed,{}),s.jsx(Ql,{}),s.jsx(zl,{})]})]})},sd=se(qs,e=>()=>{const t=Go(e);return Mt(16,t)}),nd=()=>{const[e,t]=Ct(!0),n=e?Hs:Vs,r=I(In),a=r!==We.Source,o=I(qo),i=I(sd),l=a?o():i(),{ip:m,sp:R}=I(mo);return s.jsxs("div",{className:T({"border-b":e}),children:[s.jsx(Xe,{title:"Memory",onClick:t,children:s.jsx("span",{className:"w-4",children:s.jsx(n,{className:"mx-auto fill-gray-400",width:"0.625rem"})})}),e&&s.jsx("table",{className:"text-sm w-full",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsxs("tr",{className:"divide-x bg-gray-50 text-gray-400",children:[s.jsx("td",{}),de(16).map(d=>s.jsx("td",{className:"text-center",children:s.jsx("span",{className:"px-1",children:Q(d)[1]})},d))]}),l.map((d,f)=>s.jsxs("tr",{className:"divide-x",children:[s.jsx("td",{className:"bg-gray-50 text-center text-gray-400",children:s.jsx("span",{className:"px-1",children:Q(f)[1]})}),d.map((g,w)=>{const _=f*16+w;return s.jsx("td",{className:"text-center",children:s.jsx("span",{className:T("inline-block w-full rounded",{"bg-green-100":_===m},a&&{"bg-blue-100":_===R,"bg-blue-50":_>R&&_<=Gt}),children:r===We.Hexadecimal?(F(typeof g=="number"),Q(g)):g})},w)})]},f))]})})]})},rd=!0,ad=()=>{const e=Nt(()=>$r("https://ackee.exuanbo.xyz/"));E.useEffect(()=>{const t=Wr(rd),{pathname:n,origin:r}=window.location,a=new URL(n,r),{stop:o}=e.record("bc75fd47-884f-4723-aaf6-3384103e0095",{...t,siteLocation:a.href});return o},[e])};function od(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=e;let l,m,R;const d=async(g=!0)=>{await m,R?.()};async function f(){if("serviceWorker"in navigator){if(l=await $n(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-CwtvwXb3.js");return{Workbox:g}},[],import.meta.url).then(({Workbox:g})=>new g("./sw.js",{scope:"./",type:"classic"})).catch(g=>{i?.(g)}),!l)return;R=()=>{l?.messageSkipWaiting()};{let g=!1;const w=()=>{g=!0,l?.addEventListener("controlling",_=>{_.isUpdate&&window.location.reload()}),n?.()};l.addEventListener("installed",_=>{typeof _.isUpdate>"u"?typeof _.isExternal<"u"&&_.isExternal?w():!g&&r?.():_.isUpdate||r?.()}),l.addEventListener("waiting",w)}l.register({immediate:t}).then(g=>{o?o("./sw.js",g):a?.(g)}).catch(g=>{i?.(g)})}}return m=f(),d}function id(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=e,[l,m]=E.useState(!1),[R,d]=E.useState(!1),[f]=E.useState(()=>od({immediate:t,onOfflineReady(){d(!0),r?.()},onNeedRefresh(){m(!0),n?.()},onRegistered:a,onRegisteredSW:o,onRegisterError:i}));return{needRefresh:[l,m],offlineReady:[R,d],updateServiceWorker:f}}const Ts=({onClick:e,children:t})=>s.jsx("div",{className:"border rounded bg-gray-100 py-1 px-2 inline-block hover:bg-gray-200",onClick:e,children:t}),cd=()=>{const{needRefresh:[e,t],updateServiceWorker:n}=id(),[r,a]=E.useState(!1),o=()=>{a(!0),n(!0)},i=()=>{t(!1)};return r?s.jsx("div",{className:"bg-white flex bg-opacity-80 inset-0 z-10 fixed justify-center items-center",children:s.jsx(ta,{className:"animate-spin",width:"1.5rem"})}):e?s.jsxs("div",{className:"border rounded space-y-2 bg-light-100 shadow py-2 px-4 right-4 bottom-4 fixed",children:[s.jsx("div",{children:"New version is available"}),s.jsxs("div",{className:"space-x-2",children:[s.jsx(Ts,{onClick:o,children:"Reload"}),s.jsx(Ts,{onClick:i,children:"Close"})]})]}):null},Zn=10,ld=500,dd=.25,Gs=.75,Pe=e=>e.current.offsetWidth,ud=({children:[e,t],throttle:n=Zn,className:r})=>{const a=E.useRef(null),o=E.useRef(null),i=E.useRef(null),l=E.useCallback(()=>Pe(a)-Pe(o),[]),m=E.useCallback(()=>l()-Pe(i),[l]),[R,d]=E.useState(),f=R!==void 0,g=S=>{const y=Math.round(S);d(y)},w=E.useCallback(()=>g(l()/2),[l]);E.useLayoutEffect(()=>{f||w()},[f,w]),E.useLayoutEffect(()=>{if(R!==void 0){const S=m();R>S&&g(S)}},[m,R]);const[_,A]=E.useState(!1),L=E.useRef(0),x=E.useRef(void 0),Y=()=>{A(!0),L.current+=1,L.current===2?(w(),window.clearTimeout(x.current),L.current=0):x.current=window.setTimeout(()=>{L.current=0},ld)};return E.useEffect(()=>{if(!_)return;const S=ya(V=>{const M=Pe(o),$=V.clientX-M/2,u=l(),ae=$/u,oe=ia(ae,dd,Gs),Te=oe*u;if(oe===Gs){const ve=m();if(Te>ve){g(ve);return}}g(Te)},n),y=()=>{A(!1)};return document.addEventListener("mousemove",S),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",y)}},[m,l,_,n]),s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:a,className:T("flex",r),children:[s.jsx("div",{className:T({hidden:!f}),style:{width:R},children:e}),s.jsx("div",{ref:o,className:T("border-x cursor-col-resize flex flex-col space-y-2 px-1 justify-center group hover:bg-gray-200",f?_?"bg-gray-200":"bg-gray-100":"invisible"),onMouseDown:Y,children:de(3).map(S=>s.jsx("span",{className:T("rounded-full h-1 w-1 group-hover:bg-slate-400",_?"bg-slate-400":"bg-slate-300")},S))}),s.jsx("div",{ref:i,className:T("flex-1",{hidden:!f}),children:t})]}),_&&s.jsx("div",{className:"cursor-col-resize inset-0 z-10 fixed"})]})},pd=e=>{const t=I(Ee),n=Zn*(t?2:1);return s.jsx(ud,{throttle:n,...e})},hd=()=>($l(),ad(),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx(Ic,{}),s.jsxs(pd,{className:"h-[calc(100vh-2rem)] w-full top-8 fixed",children:[s.jsx(Hl,{children:s.jsx(Fl,{})}),s.jsxs("div",{className:"flex flex-col h-full overflow-y-auto",children:[s.jsx(Pc,{}),s.jsx(nd,{}),s.jsx(td,{})]})]})]}),s.jsx(cd,{}),s.jsx(Ul,{})]})),gd=document.getElementById("app-root"),md=Jr.createRoot(gd);md.render(s.jsx(E.StrictMode,{children:s.jsx(hd,{})}));
